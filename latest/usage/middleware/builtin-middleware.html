

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Built-in middleware &#8212; Starlite Framework</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/starlite-sphinx-theme.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usage/middleware/builtin-middleware';</script>
    <script src="../../_static/versioning.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Creating Middleware" href="creating-middleware.html" />
    <link rel="prev" title="Using Middleware" href="using-middleware.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://starliteproject.dev">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">




    <nav class="navbar-nav">
        <ul id="navbar-main-elements" class="navbar-nav">
            
                
                    <li class="nav-item">
        <a class="nav-link nav-internal"
           href="../../index.html">Documentation</a>
    </li>
                
            
                
                    <div class="nav-item dropdown">
                        <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown"
                                aria-haspopup="true">
                            Community
                        </button>
                        <ul class="dropdown-menu">
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="../../contribution-guide.html">Contribution Guide</a>
    </li>
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="https://github.com/starlite-api/.github/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a>
    </li>
                            
                        </ul>
                    </div>
                
            
                
                    <div class="nav-item dropdown">
                        <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown"
                                aria-haspopup="true">
                            About
                        </button>
                        <ul class="dropdown-menu">
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="https://starliteproject.dev/about/organization">Organization</a>
    </li>
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="https://starliteproject.dev/about/starlite-releases">Releases</a>
    </li>
                            
                        </ul>
                    </div>
                
            
                
                    <div class="nav-item dropdown">
                        <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown"
                                aria-haspopup="true">
                            Release notes
                        </button>
                        <ul class="dropdown-menu">
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="https://docs.starliteproject.dev/1/changelog.html">1.x Changelog</a>
    </li>
                            
                        </ul>
                    </div>
                
            
        </ul>
    </nav>
</div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/starlite-api/starlite" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/X3FJqy8d2j" title="Discord" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">




    <nav class="navbar-nav">
        <ul id="navbar-main-elements" class="navbar-nav">
            
                
                    <li class="nav-item">
        <a class="nav-link nav-internal"
           href="../../index.html">Documentation</a>
    </li>
                
            
                
                    <div class="nav-item dropdown">
                        <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown"
                                aria-haspopup="true">
                            Community
                        </button>
                        <ul class="dropdown-menu">
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="../../contribution-guide.html">Contribution Guide</a>
    </li>
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="https://github.com/starlite-api/.github/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a>
    </li>
                            
                        </ul>
                    </div>
                
            
                
                    <div class="nav-item dropdown">
                        <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown"
                                aria-haspopup="true">
                            About
                        </button>
                        <ul class="dropdown-menu">
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="https://starliteproject.dev/about/organization">Organization</a>
    </li>
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="https://starliteproject.dev/about/starlite-releases">Releases</a>
    </li>
                            
                        </ul>
                    </div>
                
            
                
                    <div class="nav-item dropdown">
                        <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown"
                                aria-haspopup="true">
                            Release notes
                        </button>
                        <ul class="dropdown-menu">
                            
                                <li class="nav-item">
        <a class="nav-link nav-internal"
           href="https://docs.starliteproject.dev/1/changelog.html">1.x Changelog</a>
    </li>
                            
                        </ul>
                    </div>
                
            
        </ul>
    </nav>
</div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/starlite-api/starlite" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/X3FJqy8d2j" title="Discord" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Usage</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../the-starlite-app.html">The Starlite App</a></li>
<li class="toctree-l2"><a class="reference internal" href="../routing.html">Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../route-handlers.html">Route handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parameters.html">Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../request-data.html">Request data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../responses.html">Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dependency-injection.html">Dependency Injection</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">Middleware</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="using-middleware.html">Using Middleware</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Built-in middleware</a></li>
<li class="toctree-l3"><a class="reference internal" href="creating-middleware.html">Creating Middleware</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../security/index.html">Security</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/abstract-authentication-middleware.html">AbstractAuthenticationMiddleware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security-backends.html">Security Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/guards.html">Guards</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html">Testing</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../plugins/index.html">Plugins</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../plugins/piccolo-orm.html">Piccolo ORM Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/sqlalchemy.html">SQLAlchemy Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plugins/tortoise-orm.html">Tortoise ORM Plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dto.html">Data Transfer Objects (DTOs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openapi.html">OpenAPI integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lifecycle-hooks.html">Life Cycle Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../caching.html">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../templating.html">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exceptions.html">Exceptions and exception handling</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../contrib/index.html">Contrib</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../contrib/open-telemetry.html">Open Telemetry Instrumentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contrib/jwt.html">JWT Security Backends</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cli.html">CLI</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../reference/index.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../reference/app.html">starlite.app</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/cache/index.html">starlite.cache</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/cache/base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/cache/memcached_cache_backend.html">memcached_cache_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/cache/redis_cache_backend.html">redis_cache_backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/cache/simple_cache_backend.html">simple_cache_backend</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/router.html">starlite.router</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/controller.html">starlite.controller</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/datastructures/index.html">starlite.datastructures</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/background_tasks.html">background_tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/cookie.html">cookie</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/headers.html">headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/multi_dicts.html">multi_dicts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/pagination.html">pagination</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/provide.html">provide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/response_containers.html">response_containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/response_header.html">response_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/state.html">state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/upload_file.html">upload_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/datastructures/url.html">url</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/dto.html">starlite.dto</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/exceptions/index.html">starlite.exceptions</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/exceptions/base_exceptions.html">base_exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/exceptions/http_exceptions.html">http_exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/exceptions/websocket_exceptions.html">websocket_exceptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/enums.html">starlite.enums</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/config.html">starlite.config</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/connection/index.html">starlite.connection</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/connection/base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/connection/request.html">request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/connection/websocket.html">websocket</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/contrib/index.html">starlite.contrib</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/contrib/jinja.html">jinja</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/contrib/mako.html">mako</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/contrib/jwt.html">jwt</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/handlers/index.html">starlite.handlers</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/handlers/base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/handlers/asgi.html">asgi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/handlers/http.html">http</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/handlers/websocket.html">websocket</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/middleware/index.html">starlite.middleware</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/middleware/base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/middleware/allowed_hosts.html">allowed_hosts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/middleware/authentication.html">authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/middleware/compression.html">compression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/middleware/cors.html">cors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/middleware/csrf.html">csrf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/middleware/logging.html">logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/middleware/rate_limit.html">rate_limit</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../reference/middleware/session/index.html">session</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../reference/middleware/session/base.html">base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../reference/middleware/session/cookie_backend.html">cookie_backend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../reference/middleware/session/file_backend.html">file_backend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../reference/middleware/session/memcached_backend.html">memcached_backend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../reference/middleware/session/memory_backend.html">memory_backend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../reference/middleware/session/redis_backend.html">redis_backend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../reference/middleware/session/sqlalchemy_backend.html">sqlalchemy_backend</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/openapi.html">starlite.openapi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/params.html">starlite.params</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/plugins/index.html">starlite.plugins</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/plugins/base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/plugins/piccolo_orm.html">piccolo_orm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/plugins/sql_alchemy.html">sql_alchemy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/plugins/tortoise_orm.html">tortoise_orm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/response.html">starlite.response</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/security/index.html">starlite.security</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/security/base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/security/session_auth.html">session_auth</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/template.html">starlite.template</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/testing.html">starlite.testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/types.html">starlite.types</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/utils/index.html">starlite.utils</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../reference/utils/predicates.html">predicates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/utils/sync.html">sync</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/utils/scope.html">scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/utils/exception.html">exception</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/utils/extractors.html">extractors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/utils/serialization.html">serialization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../migration/index.html">Migrating to Starlite</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../migration/flask.html">From Flask</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../migration/fastapi.html">From Starlette / FastAPI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../benchmarks.html">Benchmarks</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Usage</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Middleware</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Built-in middleware</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="built-in-middleware">
<h1>Built-in middleware<a class="headerlink" href="#built-in-middleware" title="Permalink to this heading">#</a></h1>
<section id="cors">
<h2>CORS<a class="headerlink" href="#cors" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS (Cross-Origin Resource Sharing)</a> is a common security
mechanism that is often implemented using middleware. To enable CORS in a starlite application simply pass an instance
of <a class="reference internal" href="../../reference/config.html#starlite.config.CORSConfig" title="starlite.config.CORSConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CORSConfig</span></code></a> to the <a class="reference internal" href="../../reference/app.html#starlite.app.Starlite" title="starlite.app.Starlite"><code class="xref py py-class docutils literal notranslate"><span class="pre">Starlite</span> <span class="pre">constructor</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">CORSConfig</span><span class="p">,</span> <span class="n">Starlite</span>

<span class="n">cors_config</span> <span class="o">=</span> <span class="n">CORSConfig</span><span class="p">(</span><span class="n">allow_origins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;https://www.example.com&quot;</span><span class="p">])</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">cors_config</span><span class="o">=</span><span class="n">cors_config</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="csrf">
<h2>CSRF<a class="headerlink" href="#csrf" title="Permalink to this heading">#</a></h2>
<p>CSRF (Cross-site request forgery) is a type of attack where unauthorized commands are submitted from a user that the web
application trusts. This attack often uses social engineering that tricks the victim into clicking a URL that contains a
maliciously crafted, unauthorized request for a particular Web application. The user’s browser then sends this
maliciously crafted request to the targeted Web application. If the user is in an active session with the Web application,
the application treats this new request as an authorized request submitted by the user. Thus, the attacker can force the
user to perform an action the user didn’t intend, for example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POST /send-money HTTP/1.1
Host: target.web.app
Content-Type: application/x-www-form-urlencoded

amount=1000usd&amp;to=attacker@evil.com
</pre></div>
</div>
<p>This middleware prevents CSRF attacks by doing the following:</p>
<ol class="arabic simple">
<li><p>On the first “safe” request (e.g GET) - set a cookie with a special token created by the server</p></li>
<li><dl class="simple">
<dt>On each subsequent “unsafe” request (e.g POST) - make sure the request contains either a</dt><dd><p>form field or an additional header that has this token</p>
</dd>
</dl>
</li>
</ol>
<p>To enable CSRF protection in a Starlite application simply pass an instance of
<a class="reference internal" href="../../reference/config.html#starlite.config.CSRFConfig" title="starlite.config.CSRFConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CSRFConfig</span></code></a> to the Starlite constructor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span><span class="p">,</span> <span class="n">CSRFConfig</span>

<span class="n">csrf_config</span> <span class="o">=</span> <span class="n">CSRFConfig</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="s2">&quot;my-secret&quot;</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">csrf_config</span><span class="o">=</span><span class="n">csrf_config</span><span class="p">)</span>
</pre></div>
</div>
<p>Routes can be marked as being exempt from the protection offered by this middleware via
<a class="reference internal" href="../route-handlers.html#handler-opts"><span class="std std-ref">handler opts</span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">post</span>


<span class="nd">@post</span><span class="p">(</span><span class="s2">&quot;/post&quot;</span><span class="p">,</span> <span class="n">exclude_from_csrf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>If you need to exempt many routes at once you might want to consider using the
<a class="reference internal" href="../../reference/config.html#starlite.config.CSRFConfig.exclude" title="starlite.config.CSRFConfig.exclude"><code class="xref py py-attr docutils literal notranslate"><span class="pre">exclude</span></code></a> kwarg which accepts list of path
patterns to skip in the middleware.</p>
</section>
<section id="allowed-hosts">
<h2>Allowed Hosts<a class="headerlink" href="#allowed-hosts" title="Permalink to this heading">#</a></h2>
<p>Another common security mechanism is to require that each incoming request has a “Host” or “X-Forwarded-Host” header,
and then to restrict hosts to a specific set of domains - what’s called “allowed hosts”.</p>
<p>Starlite includes an <a class="reference internal" href="../../reference/middleware/allowed_hosts.html#starlite.middleware.allowed_hosts.AllowedHostsMiddleware" title="starlite.middleware.allowed_hosts.AllowedHostsMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">AllowedHostsMiddleware</span></code></a> class that can be
easily enabled by either passing an instance of <a class="reference internal" href="../../reference/config.html#starlite.config.AllowedHostsConfig" title="starlite.config.AllowedHostsConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">AllowedHostsConfig</span></code></a> or a
list of domains to the <a class="reference internal" href="../../reference/app.html#starlite.app.Starlite" title="starlite.app.Starlite"><code class="xref py py-class docutils literal notranslate"><span class="pre">Starlite</span> <span class="pre">constructor</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span><span class="p">,</span> <span class="n">AllowedHostsConfig</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span>
    <span class="n">allowed_hosts</span><span class="o">=</span><span class="n">AllowedHostsConfig</span><span class="p">(</span>
        <span class="n">allowed_hosts</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*.example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;www.wikipedia.org&quot;</span><span class="p">]</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use wildcard prefixes (<code class="docutils literal notranslate"><span class="pre">*.</span></code>) in the beginning of a domain to match any combination of subdomains. Thus,
<code class="docutils literal notranslate"><span class="pre">*.example.com</span></code> will match <code class="docutils literal notranslate"><span class="pre">www.example.com</span></code> but also <code class="docutils literal notranslate"><span class="pre">x.y.z.example.com</span></code> etc. You can also simply put <code class="docutils literal notranslate"><span class="pre">*</span></code>
in trusted hosts, which means allow all. This is akin to turning the middleware off, so in this case it may be
better to not enable it in the first place. You should note that a wildcard can only be used only in the prefix of a
domain name, not in the middle or end. Doing so will result in a validation exception being raised.</p>
</div>
</section>
<section id="compression">
<h2>Compression<a class="headerlink" href="#compression" title="Permalink to this heading">#</a></h2>
<p>HTML responses can optionally be compressed. Starlite has built in support for gzip and brotli. Gzip support is provided
through the built-in Starlette classes, and brotli support can be added by installing the <code class="docutils literal notranslate"><span class="pre">brotli</span></code> extras.</p>
<p>You can enable either backend by passing an instance of <a class="reference internal" href="../../reference/config.html#starlite.config.CompressionConfig" title="starlite.config.CompressionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompressionConfig</span></code></a>
into the <code class="docutils literal notranslate"><span class="pre">compression_config</span></code> the <a class="reference internal" href="../../reference/app.html#starlite.app.Starlite" title="starlite.app.Starlite"><code class="xref py py-class docutils literal notranslate"><span class="pre">Starlite</span> <span class="pre">constructor</span></code></a>.</p>
<section id="gzip">
<h3>GZIP<a class="headerlink" href="#gzip" title="Permalink to this heading">#</a></h3>
<p>You can enable gzip compression of responses by passing an instance of <a class="reference internal" href="../../reference/config.html#starlite.config.CompressionConfig" title="starlite.config.CompressionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">starlite.config.CompressionConfig</span></code></a> with
the <code class="docutils literal notranslate"><span class="pre">backend</span></code> parameter set to <code class="docutils literal notranslate"><span class="pre">&quot;gzip&quot;</span></code>.</p>
<p>You can configure the following additional gzip-specific values:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">minimum_size</span></code>: the minimum threshold for response size to enable compression. Smaller responses will not be</dt><dd><p>compressed. Defaults is <code class="docutils literal notranslate"><span class="pre">500</span></code>, i.e. half a kilobyte.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">gzip_compress_level</span></code>: a range between 0-9, see the <a class="reference external" href="https://docs.python.org/3/library/gzip.html">official python docs</a>.</dt><dd><p>Defaults to <code class="docutils literal notranslate"><span class="pre">9</span></code> , which is the maximum value.</p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span><span class="p">,</span> <span class="n">CompressionConfig</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span>
    <span class="n">compression_config</span><span class="o">=</span><span class="n">CompressionConfig</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">,</span> <span class="n">gzip_compress_level</span><span class="o">=</span><span class="mi">9</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="brotli">
<h3>Brotli<a class="headerlink" href="#brotli" title="Permalink to this heading">#</a></h3>
<p>The Brotli package is required to run this middleware. It is available as an extras to starlite with the <code class="docutils literal notranslate"><span class="pre">brotli</span></code>
extra (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">starlite[brotli]</span></code>).</p>
<p>You can enable brotli compression of responses by passing an instance of <a class="reference internal" href="../../reference/config.html#starlite.config.CompressionConfig" title="starlite.config.CompressionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">starlite.config.CompressionConfig</span></code></a> with
the <code class="docutils literal notranslate"><span class="pre">backend</span></code> parameter set to <code class="docutils literal notranslate"><span class="pre">&quot;brotli&quot;</span></code>.</p>
<p>You can configure the following additional brotli-specific values:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">minimum_size</span></code>: the minimum threshold for response size to enable compression. Smaller responses will not be</dt><dd><p>compressed. Defaults is <code class="docutils literal notranslate"><span class="pre">500</span></code>, i.e. half a kilobyte.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">brotli_quality</span></code>: Range [0-11], Controls the compression-speed vs compression-density tradeoff. The higher the</dt><dd><p>quality, the slower the compression.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">brotli_mode</span></code>: The compression mode can be MODE_GENERIC (default), MODE_TEXT (for UTF-8 format text input) or</dt><dd><p>MODE_FONT (for WOFF 2.0).</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">brotli_lgwin</span></code>: Base 2 logarithm of size. Range is 10 to 24. Defaults to 22.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">brotli_lgblock</span></code>: Base 2 logarithm of the maximum input block size. Range is 16 to 24. If set to 0, the value will</dt><dd><p>be set based on the quality. Defaults to 0.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">brotli_gzip_fallback</span></code>: a boolean to indicate if gzip should be used if brotli is not supported.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.config</span> <span class="kn">import</span> <span class="n">CompressionConfig</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">],</span>
    <span class="n">compression_config</span><span class="o">=</span><span class="n">CompressionConfig</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;brotli&quot;</span><span class="p">,</span> <span class="n">brotli_gzip_fallback</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="rate-limit-middleware">
<h2>Rate-Limit Middleware<a class="headerlink" href="#rate-limit-middleware" title="Permalink to this heading">#</a></h2>
<p>Starlite includes an optional <a class="reference internal" href="../../reference/middleware/rate_limit.html#starlite.middleware.rate_limit.RateLimitMiddleware" title="starlite.middleware.rate_limit.RateLimitMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">RateLimitMiddleware</span></code></a> that follows
the <a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-httpapi-ratelimit-headers/">IETF RateLimit draft specification</a>.</p>
<p>To use the rate limit middleware, use the <a class="reference internal" href="../../reference/middleware/rate_limit.html#starlite.middleware.rate_limit.RateLimitConfig" title="starlite.middleware.rate_limit.RateLimitConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">RateLimitConfig</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">MediaType</span><span class="p">,</span> <span class="n">Starlite</span><span class="p">,</span> <span class="n">get</span>
<span class="kn">from</span> <span class="nn">starlite.middleware</span> <span class="kn">import</span> <span class="n">RateLimitConfig</span>

<span class="n">rate_limit_config</span> <span class="o">=</span> <span class="n">RateLimitConfig</span><span class="p">(</span><span class="n">rate_limit</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;minute&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/schema&quot;</span><span class="p">])</span>


<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handler which should not be accessed more than once per minute.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;ok&quot;</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">handler</span><span class="p">],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">rate_limit_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">])</span>
</pre></div>
</div>
<p>The only required configuration kwarg is <code class="docutils literal notranslate"><span class="pre">rate_limit</span></code>, which expects a tuple containing a time-unit (<code class="docutils literal notranslate"><span class="pre">second</span></code>,
<code class="docutils literal notranslate"><span class="pre">minute</span></code>, <code class="docutils literal notranslate"><span class="pre">hour</span></code>, <code class="docutils literal notranslate"><span class="pre">day</span></code>) and a value for the request quota (integer). For the other configuration options.</p>
</section>
<section id="logging-middleware">
<h2>Logging Middleware<a class="headerlink" href="#logging-middleware" title="Permalink to this heading">#</a></h2>
<p>Starlite ships with a robust logging middleware that allows logging HTTP request and responses while building on
the <a class="reference internal" href="../the-starlite-app.html#logging"><span class="std std-ref">app level logging configuration</span></a>:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="3.8" for="sd-tab-item-0">
Python 3.8+</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">LoggingConfig</span><span class="p">,</span> <span class="n">Starlite</span><span class="p">,</span> <span class="n">get</span>
<span class="kn">from</span> <span class="nn">starlite.middleware</span> <span class="kn">import</span> <span class="n">LoggingMiddlewareConfig</span>

<span class="n">logging_middleware_config</span> <span class="o">=</span> <span class="n">LoggingMiddlewareConfig</span><span class="p">()</span>


<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">my_handler</span><span class="p">],</span>
    <span class="n">logging_config</span><span class="o">=</span><span class="n">LoggingConfig</span><span class="p">(),</span>
    <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">logging_middleware_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="3.9" for="sd-tab-item-1">
Python 3.9+</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">LoggingConfig</span><span class="p">,</span> <span class="n">Starlite</span><span class="p">,</span> <span class="n">get</span>
<span class="kn">from</span> <span class="nn">starlite.middleware</span> <span class="kn">import</span> <span class="n">LoggingMiddlewareConfig</span>

<span class="n">logging_middleware_config</span> <span class="o">=</span> <span class="n">LoggingMiddlewareConfig</span><span class="p">()</span>


<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">my_handler</span><span class="p">],</span>
    <span class="n">logging_config</span><span class="o">=</span><span class="n">LoggingConfig</span><span class="p">(),</span>
    <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">logging_middleware_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The logging middleware uses the logger configuration defined on the application level, which allows for using both stdlib
logging or <a class="reference external" href="https://www.structlog.org/en/stable/index.html">structlog</a> , depending on the configuration used
(see <a class="reference internal" href="../the-starlite-app.html#logging"><span class="std std-ref">app level logging configuration</span></a> for more details).</p>
<section id="obfuscating-logging-output">
<h3>Obfuscating Logging Output<a class="headerlink" href="#obfuscating-logging-output" title="Permalink to this heading">#</a></h3>
<p>Sometimes certain data, e.g. request or response headers, needs to be obfuscated. This is supported by the middleware
configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite.middleware</span> <span class="kn">import</span> <span class="n">LoggingMiddlewareConfig</span>

<span class="n">logging_middleware_config</span> <span class="o">=</span> <span class="n">LoggingMiddlewareConfig</span><span class="p">(</span>
    <span class="n">request_cookies_to_obfuscate</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;my-custom-session-key&quot;</span><span class="p">},</span>
    <span class="n">response_cookies_to_obfuscate</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;my-custom-session-key&quot;</span><span class="p">},</span>
    <span class="n">request_headers_to_obfuscate</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;my-custom-header&quot;</span><span class="p">},</span>
    <span class="n">response_headers_to_obfuscate</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;my-custom-header&quot;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The middleware will obfuscate the headers <code class="docutils literal notranslate"><span class="pre">Authorization</span></code> and <code class="docutils literal notranslate"><span class="pre">X-API-KEY</span></code> , and the cookie <code class="docutils literal notranslate"><span class="pre">session</span></code> by default.</p>
</section>
<section id="compression-and-logging-of-response-body">
<h3>Compression and Logging of Response Body<a class="headerlink" href="#compression-and-logging-of-response-body" title="Permalink to this heading">#</a></h3>
<p>If both <a class="reference internal" href="../../reference/config.html#starlite.config.CompressionConfig" title="starlite.config.compression.CompressionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompressionConfig</span></code></a> and
<a class="reference internal" href="../../reference/middleware/logging.html#starlite.middleware.logging.LoggingMiddleware" title="starlite.middleware.logging.LoggingMiddleware"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggingMiddleware</span></code></a> have been defined for the application, the response
body will be omitted from response logging if it has been compressed, even if <code class="docutils literal notranslate"><span class="pre">&quot;body&quot;</span></code> has been included in
<a class="reference internal" href="../../reference/middleware/logging.html#starlite.middleware.logging.LoggingMiddlewareConfig.response_log_fields" title="starlite.middleware.logging.LoggingMiddlewareConfig.response_log_fields"><code class="xref py py-class docutils literal notranslate"><span class="pre">response_log_fields</span></code></a>. To force the body of
compressed responses to be logged, set
<a class="reference internal" href="../../reference/middleware/logging.html#starlite.middleware.logging.LoggingMiddlewareConfig.include_compressed_body" title="starlite.middleware.logging.LoggingMiddlewareConfig.include_compressed_body"><code class="xref py py-attr docutils literal notranslate"><span class="pre">include_compressed_body</span></code></a> to <code class="docutils literal notranslate"><span class="pre">True</span></code> , in
addition to including <code class="docutils literal notranslate"><span class="pre">&quot;body&quot;</span></code> in <code class="docutils literal notranslate"><span class="pre">response_log_fields</span></code>.</p>
</section>
</section>
<section id="session-middleware">
<h2>Session Middleware<a class="headerlink" href="#session-middleware" title="Permalink to this heading">#</a></h2>
<p>Starlite includes a <code class="xref py py-class docutils literal notranslate"><span class="pre">SessionMiddleware</span></code>,
offering client- and server-side sessions. Different storage mechanisms are available through
<a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseSessionBackend" title="starlite.middleware.session.base.BaseSessionBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionBackends</span></code></a>, and include support for
storing data in:</p>
<ul class="simple">
<li><p><a class="reference external" href="clientsidesessions">Cookies</a></p></li>
<li><p><a class="reference external" href="filestorage">Files</a></p></li>
<li><p><a class="reference external" href="redisstorage">Redis</a></p></li>
<li><p><a class="reference external" href="memcachedstorage">Memcached</a> (through <code class="docutils literal notranslate"><span class="pre">aiomcache</span></code>)</p></li>
<li><p><a class="reference external" href="databasestorage">Databases</a> (through <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code>)</p></li>
<li><p><a class="reference external" href="inmemorystorage">Memory</a></p></li>
</ul>
<section id="setting-up-the-middleware">
<h3>Setting up the middleware<a class="headerlink" href="#setting-up-the-middleware" title="Permalink to this heading">#</a></h3>
<p>To start using sessions in your application all you have to do is create an instance
of a <a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseBackendConfig" title="starlite.middleware.session.base.BaseBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">configuration</span></code></a> object and
add its middleware to your application’s middleware stack:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="3.8" for="sd-tab-item-2">
Python 3.8+</label><div class="sd-tab-content docutils">
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Hello World</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">urandom</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">Starlite</span><span class="p">,</span> <span class="n">delete</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">post</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.cookie_backend</span> <span class="kn">import</span> <span class="n">CookieBackendConfig</span>

<span class="c1"># we initialize to config with a 16 byte key, i.e. 128 a bit key.</span>
<span class="c1"># in real world usage we should inject the secret from the environment</span>
<span class="n">session_config</span> <span class="o">=</span> <span class="n">CookieBackendConfig</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>  <span class="c1"># type: ignore[arg-type]</span>


<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/session&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">check_session_handler</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handler function that accesses request.session.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;has_session&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span> <span class="o">!=</span> <span class="p">{}}</span>


<span class="nd">@post</span><span class="p">(</span><span class="s2">&quot;/session&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_session_handler</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handler to set the session.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">:</span>
        <span class="c1"># value can be a dictionary or pydantic model</span>
        <span class="n">request</span><span class="o">.</span><span class="n">set_session</span><span class="p">({</span><span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;moishezuchmir&quot;</span><span class="p">})</span>


<span class="nd">@delete</span><span class="p">(</span><span class="s2">&quot;/session&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">delete_session_handler</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handler to clear the session.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">check_session_handler</span><span class="p">,</span> <span class="n">create_session_handler</span><span class="p">,</span> <span class="n">delete_session_handler</span><span class="p">],</span>
    <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="3.9" for="sd-tab-item-3">
Python 3.9+</label><div class="sd-tab-content docutils">
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Hello World</span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">urandom</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">Starlite</span><span class="p">,</span> <span class="n">delete</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">post</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.cookie_backend</span> <span class="kn">import</span> <span class="n">CookieBackendConfig</span>

<span class="c1"># we initialize to config with a 16 byte key, i.e. 128 a bit key.</span>
<span class="c1"># in real world usage we should inject the secret from the environment</span>
<span class="n">session_config</span> <span class="o">=</span> <span class="n">CookieBackendConfig</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>  <span class="c1"># type: ignore[arg-type]</span>


<span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/session&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">check_session_handler</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handler function that accesses request.session.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;has_session&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span> <span class="o">!=</span> <span class="p">{}}</span>


<span class="nd">@post</span><span class="p">(</span><span class="s2">&quot;/session&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_session_handler</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handler to set the session.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">:</span>
        <span class="c1"># value can be a dictionary or pydantic model</span>
        <span class="n">request</span><span class="o">.</span><span class="n">set_session</span><span class="p">({</span><span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;moishezuchmir&quot;</span><span class="p">})</span>


<span class="nd">@delete</span><span class="p">(</span><span class="s2">&quot;/session&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">delete_session_handler</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handler to clear the session.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">:</span>
        <span class="n">request</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">check_session_handler</span><span class="p">,</span> <span class="n">create_session_handler</span><span class="p">,</span> <span class="n">delete_session_handler</span><span class="p">],</span>
    <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since both client- and server-side sessions rely on cookies (one for storing the actual session
data, the other for storing the session ID), they share most of the cookie configuration.
A complete reference of the cookie configuration can be found at <a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseBackendConfig" title="starlite.middleware.session.base.BaseBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseBackendConfig</span></code></a>.</p>
</div>
</section>
<section id="client-side-sessions">
<h3>Client-side sessions<a class="headerlink" href="#client-side-sessions" title="Permalink to this heading">#</a></h3>
<p>Client side sessions are available through the <a class="reference internal" href="../../reference/middleware/session/cookie_backend.html#starlite.middleware.session.cookie_backend.CookieBackend" title="starlite.middleware.session.cookie_backend.CookieBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">CookieBackend</span></code></a>,
which offers strong AES-CGM encryption security best practices while support cookie splitting.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><code class="docutils literal notranslate"><span class="pre">CookieBackend</span></code> requires the <a class="reference external" href="https://cryptography.io/en/latest/">cryptography</a> library,
which can be installed together with starlite as an extra using <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">starlite[cryptography]</span></code></p>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">cookie_backend.py</span><a class="headerlink" href="#id3" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">urandom</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.cookie_backend</span> <span class="kn">import</span> <span class="n">CookieBackendConfig</span>

<span class="n">session_config</span> <span class="o">=</span> <span class="n">CookieBackendConfig</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="n">urandom</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>  <span class="c1"># type: ignore[arg-type]</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../../reference/middleware/session/cookie_backend.html#starlite.middleware.session.cookie_backend.CookieBackendConfig" title="starlite.middleware.session.cookie_backend.CookieBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CookieBackendConfig</span></code></a></p>
</div>
</section>
<section id="server-side-sessions">
<h3>Server-side sessions<a class="headerlink" href="#server-side-sessions" title="Permalink to this heading">#</a></h3>
<p>Server side session store data - as the name suggests - on the server instead of the client.
They use a cookie containing a session ID which is a randomly generated string to identify a client
and load the appropriate data from the storage backend.</p>
<section id="file-storage">
<h4>File storage<a class="headerlink" href="#file-storage" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="../../reference/middleware/session/file_backend.html#starlite.middleware.session.file_backend.FileBackend" title="starlite.middleware.session.file_backend.FileBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileBackend</span></code></a> will store session data
in files on disk, alongside some metadata. Files containing expired sessions will only be deleted
when trying to access them. Expired session files can be manually deleted using the
<a class="reference internal" href="../../reference/middleware/session/file_backend.html#starlite.middleware.session.file_backend.FileBackend.delete_expired" title="starlite.middleware.session.file_backend.FileBackend.delete_expired"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_expired</span></code></a> method.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">file_backend.py</span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.file_backend</span> <span class="kn">import</span> <span class="n">FileBackendConfig</span>

<span class="n">session_config</span> <span class="o">=</span> <span class="n">FileBackendConfig</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/session/storage&quot;</span><span class="p">))</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#accessing-the-storage-backend-directly">Accessing the storage backend directly</a></p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseBackendConfig" title="starlite.middleware.session.base.BaseBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseBackendConfig</span></code></a></p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.ServerSideSessionConfig" title="starlite.middleware.session.base.ServerSideSessionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServerSideSessionConfig</span></code></a></p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/file_backend.html#starlite.middleware.session.file_backend.FileBackendConfig" title="starlite.middleware.session.file_backend.FileBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileBackendConfig</span></code></a></p></li>
</ul>
</div>
</section>
<section id="redis-storage">
<h4>Redis storage<a class="headerlink" href="#redis-storage" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="../../reference/middleware/session/redis_backend.html#starlite.middleware.session.redis_backend.RedisBackend" title="starlite.middleware.session.redis_backend.RedisBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">Redis</span> <span class="pre">backend</span></code></a> can store session data
in redis. Session data stored in redis will expire automatically after its
<a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseBackendConfig.max_age" title="starlite.middleware.session.base.BaseBackendConfig.max_age"><code class="xref py py-attr docutils literal notranslate"><span class="pre">max_age</span></code></a> has been passed.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This requires the <code class="docutils literal notranslate"><span class="pre">redis</span></code> package. To install it you can install starlite with
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">starlite[redis]</span></code></p>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">redis_backend.py</span><a class="headerlink" href="#id5" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">redis.asyncio</span> <span class="kn">import</span> <span class="n">Redis</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.redis_backend</span> <span class="kn">import</span> <span class="n">RedisBackendConfig</span>

<span class="n">session_config</span> <span class="o">=</span> <span class="n">RedisBackendConfig</span><span class="p">(</span><span class="n">redis</span><span class="o">=</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#accessing-the-storage-backend-directly">Accessing the storage backend directly</a></p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseBackendConfig" title="starlite.middleware.session.base.BaseBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseBackendConfig</span></code></a></p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.ServerSideSessionConfig" title="starlite.middleware.session.base.ServerSideSessionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServerSideSessionConfig</span></code></a></p></li>
</ul>
</div>
</section>
<section id="memcached-storage">
<h4>Memcached storage<a class="headerlink" href="#memcached-storage" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="../../reference/middleware/session/memcached_backend.html#starlite.middleware.session.memcached_backend.MemcachedBackend" title="starlite.middleware.session.memcached_backend.MemcachedBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">Memcached</span> <span class="pre">backend</span></code></a> can store session data
in memcached. Session data stored in memcached will expire automatically after its
<a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseBackendConfig.max_age" title="starlite.middleware.session.base.BaseBackendConfig.max_age"><code class="xref py py-attr docutils literal notranslate"><span class="pre">max_age</span></code></a> has been passed.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This requires the <code class="docutils literal notranslate"><span class="pre">aiomemcache</span></code> package. To install it you can install starlite with
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">starlite[memcached]</span></code></p>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">memcached_backend.py</span><a class="headerlink" href="#id6" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aiomcache</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.memcached_backend</span> <span class="kn">import</span> <span class="n">MemcachedBackendConfig</span>

<span class="n">session_config</span> <span class="o">=</span> <span class="n">MemcachedBackendConfig</span><span class="p">(</span><span class="n">memcached</span><span class="o">=</span><span class="n">Client</span><span class="p">(</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">))</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#accessing-the-storage-backend-directly">Accessing the storage backend directly</a></p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseBackendConfig" title="starlite.middleware.session.base.BaseBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseBackendConfig</span></code></a></p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.ServerSideSessionConfig" title="starlite.middleware.session.base.ServerSideSessionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServerSideSessionConfig</span></code></a></p></li>
</ul>
</div>
</section>
<section id="in-memory-storage">
<h4>In-memory storage<a class="headerlink" href="#in-memory-storage" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="../../reference/middleware/session/memory_backend.html#starlite.middleware.session.memory_backend.MemoryBackend" title="starlite.middleware.session.memory_backend.MemoryBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">backend</span></code></a> can store
session data in memory.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This should not be used in production. It primarily exists as a dummy backend for
testing purposes. It is not process safe, and data will not be persisted.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">memory_backend.py</span><a class="headerlink" href="#id7" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.memory_backend</span> <span class="kn">import</span> <span class="n">MemoryBackendConfig</span>

<span class="n">session_config</span> <span class="o">=</span> <span class="n">MemoryBackendConfig</span><span class="p">()</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="database-storage">
<h4>Database storage<a class="headerlink" href="#database-storage" title="Permalink to this heading">#</a></h4>
<p>Database storage is currently offered through the
<a class="reference internal" href="../../reference/middleware/session/sqlalchemy_backend.html#starlite.middleware.session.sqlalchemy_backend.BaseSQLAlchemyBackend" title="starlite.middleware.session.sqlalchemy_backend.BaseSQLAlchemyBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLAlchemyBackend</span></code></a>.
It supports both sync and async-engines and integrates with the
<a class="reference internal" href="../plugins/sqlalchemy.html"><span class="doc">SQLAlchemyPlugin</span></a>. Expired sessions will only be deleted when trying to access them.
They can be manually deleted using the
<a class="reference internal" href="../../reference/middleware/session/sqlalchemy_backend.html#starlite.middleware.session.sqlalchemy_backend.BaseSQLAlchemyBackend.delete_expired" title="starlite.middleware.session.sqlalchemy_backend.BaseSQLAlchemyBackend.delete_expired"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_expired</span></code></a> method.</p>
<p>There are two backends for SQLAlchemy:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../reference/middleware/session/sqlalchemy_backend.html#starlite.middleware.session.sqlalchemy_backend.SQLAlchemyBackend" title="starlite.middleware.session.sqlalchemy_backend.SQLAlchemyBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLAlchemyBackend</span></code></a> for synchronous engines</p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/sqlalchemy_backend.html#starlite.middleware.session.sqlalchemy_backend.AsyncSQLAlchemyBackend" title="starlite.middleware.session.sqlalchemy_backend.AsyncSQLAlchemyBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncSQLAlchemyBackend</span></code></a> for asynchronous engines</p></li>
</ul>
<p>When using the <a class="reference internal" href="../../reference/middleware/session/sqlalchemy_backend.html#starlite.middleware.session.sqlalchemy_backend.SQLAlchemyBackendConfig" title="starlite.middleware.session.sqlalchemy_backend.SQLAlchemyBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">configuration</span></code></a> object,
it will automatically pick the correct backend to use based on the engine configuration.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This requires <a class="reference external" href="https://sqlalchemy.org/">sqlalchemy</a>. You can install it via
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">sqlalchemy</span></code>.</p>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-4">
Synchronous engine</label><div class="sd-tab-content docutils">
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">sqlalchemy_backend.py</span><a class="headerlink" href="#id8" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">declarative_base</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.sqlalchemy_backend</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SQLAlchemyBackendConfig</span><span class="p">,</span>
    <span class="n">create_session_model</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">starlite.plugins.sql_alchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemyConfig</span><span class="p">,</span> <span class="n">SQLAlchemyPlugin</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>

<span class="n">sqlalchemy_config</span> <span class="o">=</span> <span class="n">SQLAlchemyConfig</span><span class="p">(</span><span class="n">connection_string</span><span class="o">=</span><span class="s2">&quot;sqlite+pysqlite://&quot;</span><span class="p">,</span> <span class="n">use_async_engine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sqlalchemy_plugin</span> <span class="o">=</span> <span class="n">SQLAlchemyPlugin</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">sqlalchemy_config</span><span class="p">)</span>

<span class="n">SessionModel</span> <span class="o">=</span> <span class="n">create_session_model</span><span class="p">(</span><span class="n">Base</span><span class="p">)</span>

<span class="n">session_config</span> <span class="o">=</span> <span class="n">SQLAlchemyBackendConfig</span><span class="p">(</span><span class="n">plugin</span><span class="o">=</span><span class="n">sqlalchemy_plugin</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">SessionModel</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_startup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the database.&quot;&quot;&quot;</span>
    <span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">sqlalchemy_config</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>  <span class="c1"># type: ignore</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">],</span>
    <span class="n">plugins</span><span class="o">=</span><span class="p">[</span><span class="n">sqlalchemy_plugin</span><span class="p">],</span>
    <span class="n">on_startup</span><span class="o">=</span><span class="p">[</span><span class="n">on_startup</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-5">
Asynchronous engine</label><div class="sd-tab-content docutils">
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">sqlalchemy_backend.py</span><a class="headerlink" href="#id9" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">declarative_base</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.sqlalchemy_backend</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SQLAlchemyBackendConfig</span><span class="p">,</span>
    <span class="n">create_session_model</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">starlite.plugins.sql_alchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemyConfig</span><span class="p">,</span> <span class="n">SQLAlchemyPlugin</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>

<span class="n">SessionModel</span> <span class="o">=</span> <span class="n">create_session_model</span><span class="p">(</span><span class="n">Base</span><span class="p">)</span>

<span class="n">sqlalchemy_config</span> <span class="o">=</span> <span class="n">SQLAlchemyConfig</span><span class="p">(</span><span class="n">connection_string</span><span class="o">=</span><span class="s2">&quot;sqlite+aiosqlite://&quot;</span><span class="p">)</span>
<span class="n">sqlalchemy_plugin</span> <span class="o">=</span> <span class="n">SQLAlchemyPlugin</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">sqlalchemy_config</span><span class="p">)</span>
<span class="n">session_config</span> <span class="o">=</span> <span class="n">SQLAlchemyBackendConfig</span><span class="p">(</span>
    <span class="n">plugin</span><span class="o">=</span><span class="n">sqlalchemy_plugin</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">SessionModel</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">on_startup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the database.&quot;&quot;&quot;</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">sqlalchemy_config</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">await</span> <span class="n">conn</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">)</span>  <span class="c1"># pyright: ignore</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">],</span> <span class="n">plugins</span><span class="o">=</span><span class="p">[</span><span class="n">sqlalchemy_plugin</span><span class="p">],</span> <span class="n">on_startup</span><span class="o">=</span><span class="p">[</span><span class="n">on_startup</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<section id="supplying-your-own-session-model">
<h5>Supplying your own session model<a class="headerlink" href="#supplying-your-own-session-model" title="Permalink to this heading">#</a></h5>
<p>If you wish to extend the built-in session model, you can mixin the
<a class="reference internal" href="../../reference/middleware/session/sqlalchemy_backend.html#starlite.middleware.session.sqlalchemy_backend.SessionModelMixin" title="starlite.middleware.session.sqlalchemy_backend.SessionModelMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionModelMixin</span></code></a> into your own classes:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">sqlalchemy_backend_custom_model.py</span><a class="headerlink" href="#id10" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">String</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="kn">import</span> <span class="n">declarative_base</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.sqlalchemy_backend</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SessionModelMixin</span><span class="p">,</span>
    <span class="n">SQLAlchemyBackendConfig</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">starlite.plugins.sql_alchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemyConfig</span><span class="p">,</span> <span class="n">SQLAlchemyPlugin</span>

<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">SessionModel</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">SessionModelMixin</span><span class="p">):</span>  <span class="c1"># pyright: ignore [reportGeneralTypeIssues]</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;my-session-table&quot;</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">additional_data</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">)</span>


<span class="n">sqlalchemy_config</span> <span class="o">=</span> <span class="n">SQLAlchemyConfig</span><span class="p">(</span><span class="n">connection_string</span><span class="o">=</span><span class="s2">&quot;sqlite+aiosqlite://&quot;</span><span class="p">)</span>
<span class="n">sqlalchemy_plugin</span> <span class="o">=</span> <span class="n">SQLAlchemyPlugin</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">sqlalchemy_config</span><span class="p">)</span>
<span class="n">session_config</span> <span class="o">=</span> <span class="n">SQLAlchemyBackendConfig</span><span class="p">(</span>
    <span class="n">plugin</span><span class="o">=</span><span class="n">sqlalchemy_plugin</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">SessionModel</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">on_startup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the database.&quot;&quot;&quot;</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">sqlalchemy_config</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">await</span> <span class="n">conn</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">)</span>  <span class="c1"># pyright: ignore</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span>
    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_config</span><span class="o">.</span><span class="n">middleware</span><span class="p">],</span> <span class="n">plugins</span><span class="o">=</span><span class="p">[</span><span class="n">sqlalchemy_plugin</span><span class="p">],</span> <span class="n">on_startup</span><span class="o">=</span><span class="p">[</span><span class="n">on_startup</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.BaseBackendConfig" title="starlite.middleware.session.base.BaseBackendConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseBackendConfig</span></code></a></p></li>
<li><p><a class="reference internal" href="../../reference/middleware/session/base.html#starlite.middleware.session.base.ServerSideSessionConfig" title="starlite.middleware.session.base.ServerSideSessionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServerSideSessionConfig</span></code></a></p></li>
</ul>
</div>
</section>
</section>
</section>
<section id="accessing-the-storage-backend-directly">
<h3>Accessing the storage backend directly<a class="headerlink" href="#accessing-the-storage-backend-directly" title="Permalink to this heading">#</a></h3>
<p>In some situations you might want to access the storage backend directly, outside a
request. For example to delete a specific session’s data, or delete expired sessions
from the database when using the <a class="reference internal" href="../../reference/middleware/session/sqlalchemy_backend.html#starlite.middleware.session.sqlalchemy_backend.BaseSQLAlchemyBackend" title="starlite.middleware.session.sqlalchemy_backend.BaseSQLAlchemyBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">SQLAlchemyBackend</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">starlite</span> <span class="kn">import</span> <span class="n">Starlite</span>
<span class="kn">from</span> <span class="nn">starlite.middleware.session.file_backend</span> <span class="kn">import</span> <span class="n">FileBackend</span><span class="p">,</span> <span class="n">FileBackendConfig</span>

<span class="n">session_config</span> <span class="o">=</span> <span class="n">FileBackendConfig</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/session/storage&quot;</span><span class="p">))</span>
<span class="n">session_backend</span> <span class="o">=</span> <span class="n">FileBackend</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">session_config</span><span class="p">)</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">clear_expired_sessions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete all expired sessions.&quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="n">session_backend</span><span class="o">.</span><span class="n">delete_expired</span><span class="p">()</span>


<span class="n">app</span> <span class="o">=</span> <span class="n">Starlite</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[],</span> <span class="n">middleware</span><span class="o">=</span><span class="p">[</span><span class="n">session_backend</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">middleware</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="using-middleware.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Using Middleware</p>
      </div>
    </a>
    <a class="right-next"
       href="creating-middleware.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Creating Middleware</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cors">CORS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#csrf">CSRF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#allowed-hosts">Allowed Hosts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compression">Compression</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gzip">GZIP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brotli">Brotli</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rate-limit-middleware">Rate-Limit Middleware</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-middleware">Logging Middleware</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obfuscating-logging-output">Obfuscating Logging Output</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compression-and-logging-of-response-body">Compression and Logging of Response Body</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-middleware">Session Middleware</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-the-middleware">Setting up the middleware</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#client-side-sessions">Client-side sessions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#server-side-sessions">Server-side sessions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#file-storage">File storage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#redis-storage">Redis storage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#memcached-storage">Memcached storage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#in-memory-storage">In-memory storage</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#database-storage">Database storage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#supplying-your-own-session-model">Supplying your own session model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-the-storage-backend-directly">Accessing the storage backend directly</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner"></div>
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, Starlite-API.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>