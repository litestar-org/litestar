<!DOCTYPE html>
<html lang="en" data-accent-color="amber" data-content_root="../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Responses - Litestar Framework</title><link rel="shortcut icon" href="../_static/favicon.svg"/><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Security" href="security/index.html" /><link rel="prev" title="Problem Details" href="plugins/problem_details.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=397bb51e" />
    <link rel="stylesheet" type="text/css" href="../_static/shibuya.css?v=76b6f612" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_paramlinks.css" />
    <link media="print" rel="stylesheet" type="text/css" href="../_static/print.css?v=20ff2c19" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=50ea2f63" />
    <link rel="stylesheet" type="text/css" href="../_static/litestar-sphinx-theme.css?v=f8f74789" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/><meta property="og:title" content="Responses"/>
<meta name="twitter:card" content="summary"/>
<meta property="og:image" content="_static/logo-light.png"/>
  </head>
<body><div class="announcement">
    <div class="announcement-inner">
      <p>You are viewing the <bold>local</bold> version of the documentation. Click here to go to the latest version.</p>
      <button class="announcement-close" aria-label="Close announcement">
        <i class="i-lucide close"></i>
      </button>
    </div>
  </div><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="/">
      <img class="light-logo" src="../_static/logo-light.png" alt="Litestar" height="28" loading="lazy" />
      <img class="dark-logo" src="../_static/logo-dark.png" alt="Litestar" height="28" loading="lazy" />
      <strong>Litestar</strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"><ul><li class="link"><a href="../index.html">Home</a></li>
      <li class="link"><button class="js-menu" type="button" id="nav-trigger-2" aria-controls="nav-children-2">
            <span>Community</span>
            <i class="i-lucide chevron-down"></i>
          </button>
        <ul id="nav-children-2" aria-labelledby="nav-trigger-2"><li><a href="../contribution-guide.html">
                <span>Contributing</span>
                <small>Learn how to contribute to the Litestar project</small>
              </a></li><li><a href="https://github.com/litestar-org/.github?tab=coc-ov-file">
                <span>Code of Conduct</span>
                <small>Review the etiquette for interacting with the Litestar community</small>
              </a></li><li><a href="https://github.com/litestar-org/.github?tab=coc-ov-file#security-ov-file">
                <span>Security</span>
                <small>Overview of Litestar's security protocols</small>
              </a></li></ul>
      </li>
      <li class="link"><button class="js-menu" type="button" id="nav-trigger-3" aria-controls="nav-children-3">
            <span>About</span>
            <i class="i-lucide chevron-down"></i>
          </button>
        <ul id="nav-children-3" aria-labelledby="nav-trigger-3"><li><a href="https://litestar.dev/about/organization">
                <span>Litestar Organization</span>
                <small>Details about the Litestar organization</small>
              </a></li><li><a href="https://litestar.dev/about/litestar-releases">
                <span>Releases</span>
                <small>Explore the release process, versioning, and deprecation policy for Litestar</small>
              </a></li></ul>
      </li>
      <li class="link"><button class="js-menu" type="button" id="nav-trigger-4" aria-controls="nav-children-4">
            <span>Release notes</span>
            <i class="i-lucide chevron-down"></i>
          </button>
        <ul id="nav-children-4" aria-labelledby="nav-trigger-4"><li><a href="../release-notes/whats-new-3.html">
                <span>What's new in 3.0</span>
                <small>Explore the new features in Litestar 3.0</small>
              </a></li><li><a href="../release-notes/changelog.html">
                <span>3.x Changelog</span>
                <small>All changes in the 3.x series</small>
              </a></li><li><a href="https://docs.litestar.dev/2/release-notes/changelog.html">
                <span>2.x Changelog</span>
                <small>All changes in the 2.x series</small>
              </a></li></ul>
      </li>
      <li class="link"><button class="js-menu" type="button" id="nav-trigger-5" aria-controls="nav-children-5">
            <span>Help</span>
            <i class="i-lucide chevron-down"></i>
          </button>
        <ul id="nav-children-5" aria-labelledby="nav-trigger-5"><li><a href="https://discord.gg/litestar">
                <span>Discord Help Forum</span>
                <small>Dedicated Discord help forum</small>
              </a></li><li><a href="https://github.com/orgs/litestar-org/discussions">
                <span>GitHub Discussions</span>
                <small>GitHub Discussions</small>
              </a></li><li><a href="https://stackoverflow.com/questions/tagged/litestar">
                <span>Stack Overflow</span>
                <small>We monitor the <code><b>litestar</b></code> tag on Stack Overflow</small>
              </a></li></ul>
      </li><li class="link">
          <a href="https://github.com/sponsors/Litestar-Org">
            <span>Sponsor</span></a>
        </li></ul></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="nav-versions">
    <button type="button" aria-label="Versions">
      <span class="md:hidden">Versions</span>
      <span class="hidden md:inline">main</span>
      <i class="i-lucide chevron-down"></i>
    </button>
    <div class="nav-versions-choices"><ul><li><a href="/latest">latest</a></li><li><a href="/main">v3 (development)</a></li><li><a href="/2">v2</a></li><li><a href="/1">v1</a></li></ul></div>
  </div><div class="sy-head-socials">
<a href="https://twitter.com/LitestarAPI" aria-label="X (Twitter)">
  <iconify-icon icon="prime:twitter"></iconify-icon>
</a>
  <a href="https://discord.gg/litestar" aria-label="Discord">
    <iconify-icon icon="simple-icons:discord"></iconify-icon>
  </a></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2 -translate-x-2"></span>
          <span class="hamburger_3 -translate-x-1"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6"><div class="sidebar-links">
  <ul>
    <li><a class="icon-link" href="https://github.com/orgs/litestar-org/discussions">
  <span class="icon">
    <svg viewBox="0 0 24 24" fill="none">
      <path fill="var(--accent-9)" fill-rule="evenodd" clip-rule="evenodd" d="M11 5a6 6 0 0 0-4.687 9.746c.215.27.315.62.231.954l-.514 2.058a1 1 0 0 0 1.485 1.1l2.848-1.71c.174-.104.374-.15.576-.148H13a6 6 0 0 0 0-12h-2Z"/>
      <circle fill="white" cx="12" cy="11" r="1"/>
      <circle fill="white" cx="9" cy="11" r="1"/>
      <circle fill="white" cx="15" cy="11" r="1"/>
    </svg>
  </span>
  <span class="text">Discussion</span>
</a></li>
  </ul>
</div>
        <div class="globaltoc" data-expand-depth="0"><p class="caption" role="heading" aria-level="3"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Usage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="routing/index.html">Routing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="routing/overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="routing/handlers.html">Route handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="routing/parameters.html">Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="requests.html">Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="caching.html">Caching</a></li>
<li class="toctree-l2"><a class="reference internal" href="channels.html">Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="databases/index.html">Databases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="databases/sqlalchemy/index.html">SQLAlchemy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="databases/sqlalchemy/models_and_repository.html">SQLAlchemy Models &amp; Repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="databases/sqlalchemy/plugins/index.html">Plugins</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="databases/piccolo.html">Piccolo ORM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="dependency-injection.html">Dependency Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="dto/index.html">Data Transfer Object (DTO)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dto/0-basic-use.html">Basic Use</a></li>
<li class="toctree-l3"><a class="reference internal" href="dto/1-abstract-dto.html">AbstractDTO</a></li>
<li class="toctree-l3"><a class="reference internal" href="dto/2-creating-custom-dto-classes.html">Implementing Custom DTO Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="exceptions.html">Exceptions and exception handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_systems.html">File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="htmx.html">HTMX</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifecycle-hooks.html">Life Cycle Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics/index.html">Metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="metrics/open-telemetry.html">OpenTelemetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="metrics/prometheus.html">Prometheus</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="middleware/index.html">Middleware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="middleware/using-middleware.html">Using Middleware</a></li>
<li class="toctree-l3"><a class="reference internal" href="middleware/builtin-middleware.html">Built-in middleware</a></li>
<li class="toctree-l3"><a class="reference internal" href="middleware/creating-middleware.html">Creating Middleware</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="openapi/index.html">OpenAPI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="openapi/schema_generation.html">Configuring schema generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/schema_generation.html#configuring-schema-generation-on-a-route-handler">Configuring schema generation on a route handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/schema_generation.html#accessing-the-openapi-schema-in-code">Accessing the OpenAPI schema in code</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/schema_generation.html#customizing-pydantic-model-schemas">Customizing Pydantic model schemas</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/schema_generation.html#customizing-operation-class">Customizing <code class="docutils literal notranslate"><span class="pre">Operation</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/schema_generation.html#generating-examples">Generating examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html">OpenAPI UI Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html#using-openapi-ui-plugins">Using OpenAPI UI Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html#configuring-openapi-ui-plugins">Configuring OpenAPI UI Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html#configuring-the-openapi-root-path">Configuring the OpenAPI Root Path</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html#building-your-own-openapi-ui-plugin">Building your own OpenAPI UI Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html#interacting-with-the-router">Interacting with the <code class="docutils literal notranslate"><span class="pre">Router</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html#oauth2-in-swagger-ui">OAuth2 in Swagger UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html#customizing-the-openapi-ui">Customizing the OpenAPI UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="openapi/ui_plugins.html#cdn-and-offline-file-support">CDN and offline file support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins/index.html">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/flash_messages.html">Flash Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/problem_details.html">Problem Details</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="security/index.html">Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="security/abstract-authentication-middleware.html">Implementing Custom Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="security/security-backends.html">Security Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="security/guards.html">Guards</a></li>
<li class="toctree-l3"><a class="reference internal" href="security/excluding-and-including-endpoints.html">Excluding and including endpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="security/jwt.html">JWT Security Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="security/secret-datastructures.html">Handling Secrets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="static-files.html">Static files</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom-types.html">Custom types</a></li>
<li class="toctree-l2"><a class="reference internal" href="stores.html">Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="templating.html">Templating</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="websockets.html">WebSockets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/app.html">app</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/background_tasks.html">background_tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/channels/index.html">channels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/channels/plugin.html">plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/channels/subscriber.html">subscriber</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/channels/backends/index.html">backends</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/channels/backends/base.html">base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/channels/backends/memory.html">memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/channels/backends/redis.html">redis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/channels/backends/psycopg.html">psycopg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/channels/backends/asyncpg.html">asyncpg</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli.html">cli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/config.html">config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/connection.html">connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/contrib/index.html">contrib</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/contrib/htmx.html">HTMX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/contrib/jinja.html">jinja</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/contrib/jwt.html">jwt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/contrib/mako.html">mako</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/contrib/opentelemetry.html">opentelemetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/contrib/piccolo.html">piccolo_orm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/contrib/pydantic.html">pydantic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/contrib/sqlalchemy/index.html">sqlalchemy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/contrib/sqlalchemy/plugins.html">plugins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/contrib/sqlalchemy/repository.html">repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/contrib/sqlalchemy/types.html">types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/contrib/sqlalchemy/base.html">base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/contrib/sqlalchemy/dto.html">DTO</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controller.html">controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/concurrency.html">concurrency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/data_extractors.html">data_extractors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/datastructures/index.html">datastructures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/datastructures/secret_values.html">secret_values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/di.html">di</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/dto/index.html">dto</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/dto/config.html">config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/dto/data_structures.html">data_structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/dto/field.html">field</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/dto/types.html">types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/dto/base_dto.html">base_dto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/dto/msgspec_dto.html">msgspec_dto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/dto/dataclass_dto.html">dataclass_dto</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/enums.html">enums</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/events.html">events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/exceptions.html">exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/file_system.html">file_system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/handlers.html">handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/logging/index.html">logging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/logging/config.html">config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/logging/picologging.html">picologging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/logging/standard.html">standard</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/middleware/index.html">middleware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/middleware/allowed_hosts.html">allowed_hosts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/middleware/authentication.html">authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/middleware/compression.html">compression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/middleware/csrf.html">csrf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/middleware/logging.html">logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/middleware/rate_limit.html">rate_limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/middleware/session/index.html">session</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/middleware/session/base.html">base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/middleware/session/client_side.html">client_side</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/middleware/session/server_side.html">server_side</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/middleware/constraints.html">constraints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/openapi/index.html">openapi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/openapi/openapi.html">openapi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/openapi/plugins.html">plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/openapi/spec.html">spec</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/pagination.html">pagination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/params.html">params</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/plugins/index.html">plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/plugins/attrs.html">attrs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/plugins/flash_messages.html">flash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/plugins/htmx.html">htmx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/plugins/problem_details.html">problem details</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/plugins/prometheus.html">prometheus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/plugins/pydantic.html">pydantic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/plugins/structlog.html">structlog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/plugins/sqlalchemy.html">sqlalchemy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/repository/index.html">repository</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/repository/abc.html">abc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/repository/filters.html">filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/repository/exceptions.html">exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/repository/testing.html">testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/repository/handlers.html">handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/response/index.html">response</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/response/base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/response/file.html">file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/response/redirect.html">redirect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/response/streaming.html">streaming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/response/sse.html">SSE (Server Sent Events)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/response/template.html">template</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/router.html">router</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/routes.html">routes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/security/index.html">security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/security/jwt.html">jwt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/security/session_auth.html">session_auth</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/serialization.html">serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/static_files.html">static_files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/status_codes.html">status_code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/stores/index.html">stores</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/stores/base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/stores/file.html">file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/stores/memory.html">memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/stores/redis.html">redis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/stores/registry.html">registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/stores/valkey.html">valkey</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/template.html">template</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/testing.html">testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/types.html">types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/typing.html">typing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../migration/index.html">Migrating to Litestar</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../migration/flask.html">From Flask</a></li>
<li class="toctree-l2"><a class="reference internal" href="../migration/fastapi.html">From Starlette / FastAPI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topics/index.html">Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../topics/sync-vs-async.html">Sync vs. Async</a></li>
<li class="toctree-l2"><a class="reference internal" href="../topics/deployment/index.html">Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../topics/deployment/nginx-unit.html">NGINX Unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/deployment/manually-with-asgi-server.html">Manually with ASGI server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/deployment/docker.html">Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topics/deployment/supervisor.html">Supervisor (Linux)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/todo-app/index.html">Developing a basic TODO application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/todo-app/0-application-basics.html">Application basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/todo-app/1-accessing-the-list.html">Accessing the list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/todo-app/2-interacting-with-the-list.html">Making the list interactive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/todo-app/3-assembling-the-app.html">Recap and assembling the final application</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/sqlalchemy/index.html">Improving the TODO app with SQLAlchemy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sqlalchemy/0-introduction.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sqlalchemy/1-provide-session-with-di.html">Providing the session with DI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sqlalchemy/2-serialization-plugin.html">Using the serialization plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sqlalchemy/3-init-plugin.html">Using the init plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sqlalchemy/4-final-touches-and-recap.html">Final touches and recap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/dto-tutorial/index.html">Data Transfer Object Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/01-simple-dto-exclude.html">Our first DTO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/02-nested-exclude.html">Excluding from nested models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/03-nested-collection-exclude.html">Excluding from collections of nested models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/04-max-nested-depth.html">Max nested depth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/05-renaming-fields.html">Renaming fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/06-receiving-data.html">Receiving data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/07-read-only-fields.html">Read only fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/08-dto-data.html">Accessing the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/09-updating.html">Updating instances</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/dto-tutorial/10-layered-dto-declarations.html">Declaring DTOs on app layers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/repository-tutorial/index.html">SQLAlchemy Repository Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/01-modelling-and-features.html">Introduction to Database Modelling and Repository Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/01-modelling-and-features.html#modelling">Modelling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/01-modelling-and-features.html#full-code">Full Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/02-repository-introduction.html">Interacting with repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/02-repository-introduction.html#working-with-bulk-data-operations">Working with Bulk Data Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/02-repository-introduction.html#full-code">Full Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/03-repository-controller.html">Working with Controllers and Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/03-repository-controller.html#full-code">Full Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/04-repository-other.html">Adding Additional Features to the Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/04-repository-other.html#slug-fields">Slug Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/repository-tutorial/04-repository-other.html#full-code">Full Code</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading" aria-level="3"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribution-guide.html">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/search?q=user%3Alitestar-org+state%3Aopen+label%3A%22good+first+issue%22+++no%3Aassignee+&amp;type=issues=">Available Issues</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/litestar-org/.github?tab=coc-ov-file#readme">Code of Conduct</a></li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3><ul>
<li><a class="reference internal" href="#media-type">Media Type</a><ul>
<li><a class="reference internal" href="#json-responses">JSON responses</a></li>
<li><a class="reference internal" href="#messagepack-responses">MessagePack responses</a></li>
<li><a class="reference internal" href="#plaintext-responses">Plaintext responses</a></li>
<li><a class="reference internal" href="#html-responses">HTML responses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#content-negotiation">Content Negotiation</a></li>
<li><a class="reference internal" href="#status-codes">Status Codes</a></li>
<li><a class="reference internal" href="#returning-responses">Returning responses</a><ul>
<li><a class="reference internal" href="#annotating-responses">Annotating responses</a></li>
<li><a class="reference internal" href="#returning-asgi-applications">Returning ASGI Applications</a><ul>
<li><a class="reference internal" href="#what-is-an-asgi-application">What is an ASGI Application?</a><ul>
<li><a class="reference internal" href="#function-asgi-application">Function ASGI Application</a></li>
<li><a class="reference internal" href="#method-asgi-application">Method ASGI Application</a></li>
<li><a class="reference internal" href="#class-asgi-application">Class ASGI Application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#returning-responses-from-third-party-libraries">Returning responses from third party libraries</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#setting-response-headers">Setting Response Headers</a><ul>
<li><a class="reference internal" href="#setting-headers-dynamically">Setting Headers Dynamically</a><ul>
<li><a class="reference internal" href="#using-annotated-responses">Using Annotated Responses</a></li>
<li><a class="reference internal" href="#using-the-after-request-hook">Using the After Request Hook</a></li>
</ul>
</li>
<li><a class="reference internal" href="#predefined-headers">Predefined Headers</a><ul>
<li><a class="reference internal" href="#cache-control">Cache Control</a></li>
<li><a class="reference internal" href="#etag">ETag</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#setting-response-cookies">Setting Response Cookies</a><ul>
<li><a class="reference internal" href="#setting-cookies-dynamically">Setting Cookies dynamically</a><ul>
<li><a class="reference internal" href="#id2">Using Annotated Responses</a></li>
<li><a class="reference internal" href="#id3">Using the After Request Hook</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#redirect-responses">Redirect Responses</a></li>
<li><a class="reference internal" href="#file-responses">File Responses</a><ul>
<li><a class="reference internal" href="#media-types">Media types</a></li>
<li><a class="reference internal" href="#streaming">Streaming</a></li>
<li><a class="reference internal" href="#file-systems">File systems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#streaming-responses">Streaming Responses</a></li>
<li><a class="reference internal" href="#server-sent-event-responses">Server Sent Event Responses</a></li>
<li><a class="reference internal" href="#template-responses">Template Responses</a></li>
<li><a class="reference internal" href="#custom-responses">Custom Responses</a></li>
<li><a class="reference internal" href="#background-tasks">Background Tasks</a><ul>
<li><a class="reference internal" href="#executing-multiple-background-tasks">Executing Multiple Background Tasks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pagination">Pagination</a><ul>
<li><a class="reference internal" href="#classic-pagination">Classic Pagination</a></li>
<li><a class="reference internal" href="#offset-pagination">Offset Pagination</a><ul>
<li><a class="reference internal" href="#offset-pagination-with-sqlalchemy">Offset Pagination With SQLAlchemy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cursor-pagination">Cursor Pagination</a></li>
</ul>
</li>
</ul>
</div><a class="js-repo-stats repo-stats flex items-center" href="https://github.com/litestar-org/litestar"
  data-type="github" data-user="litestar-org" data-repo="litestar">
  <span class="w-8 flex items-center justify-around shrink-0 text-3xl">
    <iconify-icon icon="simple-icons:github"></iconify-icon>
  </span>
  <span class="flex-grow px-2 break-all">
    <span>litestar-org/litestar</span>
    <span class="flex text-sm repo-stats-count">
      <span class="flex items-center pr-3">
        <iconify-icon icon="lucide:star"></iconify-icon>
        <strong class="js-repo-stars ml-1">0</strong>
      </span>
      <span class="flex items-center">
        <iconify-icon icon="lucide:git-fork"></iconify-icon>
        <strong class="js-repo-forks ml-1">0</strong>
      </span>
    </span>
  </span>
</a><div class="edit-this-page">
  <a href="https://github.com/litestar-org/litestar/blob/main/docs/usage/responses.rst">Edit this page</a>
</div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">Litestar</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="index.html"><span itemprop="name">Usage</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">Responses</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
        <article class="yue" role="main">
          <section id="responses">
<h1>Responses<a class="headerlink" href="#responses" title="Link to this heading">¶</a></h1>
<p>Litestar allows for several ways in which HTTP responses can be specified and handled, each fitting a different use
case. The base pattern though is straightforward - simply return a value from a route handler function and let
Litestar take care of the rest:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span>
</span><span data-line="3">
</span><span data-line="4">
</span><span data-line="5"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="6">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="7">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="8">
</span><span data-line="9">
</span><span data-line="10"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/resources&quot;</span><span class="p">)</span>
</span><span data-line="11"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Resource</span><span class="p">:</span>
</span><span data-line="12">    <span class="k">return</span> <span class="n">Resource</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>In the example above, the route handler function returns an instance of the <code class="docutils literal notranslate"><span class="pre">Resource</span></code> pydantic class. This value will
then be used by Litestar to construct an instance of the <a class="reference internal" href="../reference/response/index.html#litestar.response.Response" title="litestar.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a>
class using defaults values: the response status code will be set to <code class="docutils literal notranslate"><span class="pre">200</span></code> and it’s <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header will be set
to <code class="docutils literal notranslate"><span class="pre">application/json</span></code>. The <code class="docutils literal notranslate"><span class="pre">Resource</span></code> instance will be serialized into JSON and set as the response body.</p>
<section id="media-type">
<h2>Media Type<a class="headerlink" href="#media-type" title="Link to this heading">¶</a></h2>
<p>You do not have to specify the <code class="docutils literal notranslate"><span class="pre">media_type</span></code> kwarg in the route handler function if the response should be JSON. But
if you wish to return a response other than JSON, you should specify this value. You can use
the <a class="reference internal" href="../reference/enums.html#litestar.enums.MediaType" title="litestar.enums.MediaType"><code class="xref py py-class docutils literal notranslate"><span class="pre">MediaType</span></code></a> enum for this purpose:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">MediaType</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="2">
</span><span data-line="3">
</span><span data-line="4"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/resources&quot;</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="6">    <span class="k">return</span> <span class="s2">&quot;The rumbling rabbit ran around the rock&quot;</span>
</span></pre></div>
</div>
<p>The value of the <code class="docutils literal notranslate"><span class="pre">media_type</span></code> kwarg affects both the serialization of response data and the generation of OpenAPI docs.
The above example will cause Litestar to serialize the response as a simple bytes string with a <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header
value of <code class="docutils literal notranslate"><span class="pre">text/plain</span></code>. It will also set the corresponding values in the OpenAPI documentation.</p>
<p>MediaType has the following members:</p>
<ul class="simple">
<li><p>MediaType.JSON: <code class="docutils literal notranslate"><span class="pre">application/json</span></code></p></li>
<li><p>MediaType.MessagePack: <code class="docutils literal notranslate"><span class="pre">application/x-msgpack</span></code></p></li>
<li><p>MediaType.TEXT: <code class="docutils literal notranslate"><span class="pre">text/plain</span></code></p></li>
<li><p>MediaType.HTML: <code class="docutils literal notranslate"><span class="pre">text/html</span></code></p></li>
</ul>
<p>You can also set any <a class="reference external" href="https://www.iana.org/assignments/media-types/media-types.xhtml">IANA referenced</a> media type
string as the <code class="docutils literal notranslate"><span class="pre">media_type</span></code>. While this will still affect the OpenAPI generation as expected, you might need to handle
serialization using either a <a class="reference internal" href="#custom-responses"><span class="std std-ref">custom response</span></a> with serializer or by serializing
the value in the route handler function.</p>
<section id="json-responses">
<h3>JSON responses<a class="headerlink" href="#json-responses" title="Link to this heading">¶</a></h3>
<p>As previously mentioned, the default <code class="docutils literal notranslate"><span class="pre">media_type</span></code> is <code class="docutils literal notranslate"><span class="pre">MediaType.JSON</span></code>. which supports the following values:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/dataclasses.html" title="(in Python v3.13)"><span class="xref std std-doc">dataclasses</span></a></p></li>
<li><p><a class="reference external" href="https://docs.pydantic.dev/usage/dataclasses/">pydantic dataclasses</a></p></li>
<li><p><a class="reference external" href="https://docs.pydantic.dev/usage/models/">pydantic models</a></p></li>
<li><p>models from libraries that extend pydantic models</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/uuid.html#uuid.UUID" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">UUIDs</span></code></a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/datetime.html" title="(in Python v3.13)"><span class="xref std std-doc">datetime objects</span></a></p></li>
<li><p><a class="reference external" href="https://jcristharif.com/msgspec/structs.html">msgspec.Struct</a></p></li>
<li><p>container types such as <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> containing supported types</p></li>
</ul>
<p>If you need to return other values and would like to extend serialization you can do
this <a class="reference internal" href="#custom-responses"><span class="std std-ref">custom responses</span></a>.</p>
<p>You can also set an application media type string with the <code class="docutils literal notranslate"><span class="pre">+json</span></code> suffix
defined in <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc6839#section-3.1">RFC 6839</a>
as the <code class="docutils literal notranslate"><span class="pre">media_type</span></code> and it will be recognized and serialized as json.</p>
<p>For example, you can use <code class="docutils literal notranslate"><span class="pre">application/vnd.example.resource+json</span></code>
and it will work just like json but have the appropriate content-type header
and show up in the generated OpenAPI schema.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">import</span><span class="w"> </span><span class="nn">litestar.status_codes</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="5">
</span><span data-line="6">
</span><span data-line="7"><span class="nd">@get</span><span class="p">(</span>
</span><span data-line="8">    <span class="s2">&quot;/resources&quot;</span><span class="p">,</span>
</span><span data-line="9">    <span class="n">status_code</span><span class="o">=</span><span class="n">litestar</span><span class="o">.</span><span class="n">status_codes</span><span class="o">.</span><span class="n">HTTP_418_IM_A_TEAPOT</span><span class="p">,</span>
</span><span data-line="10">    <span class="n">media_type</span><span class="o">=</span><span class="s2">&quot;application/vnd.example.resource+json&quot;</span><span class="p">,</span>
</span><span data-line="11"><span class="p">)</span>
</span><span data-line="12"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span data-line="13">    <span class="k">return</span> <span class="p">{</span>
</span><span data-line="14">        <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Server thinks it is a teapot&quot;</span><span class="p">,</span>
</span><span data-line="15">        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Server delusion&quot;</span><span class="p">,</span>
</span><span data-line="16">        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">litestar</span><span class="o">.</span><span class="n">status_codes</span><span class="o">.</span><span class="n">HTTP_418_IM_A_TEAPOT</span><span class="p">,</span>
</span><span data-line="17">    <span class="p">}</span>
</span><span data-line="18">
</span><span data-line="19">
</span><span data-line="20"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">])</span>
</span></pre></div>
</div>
</section>
<section id="messagepack-responses">
<h3>MessagePack responses<a class="headerlink" href="#messagepack-responses" title="Link to this heading">¶</a></h3>
<p>In addition to JSON, Litestar offers support for the <a class="reference external" href="https://msgpack.org/">MessagePack</a>
format which can be a time and space efficient alternative to JSON.</p>
<p>It supports all the same types as JSON serialization. To send a <code class="docutils literal notranslate"><span class="pre">MessagePack</span></code> response,
simply specify the media type as <code class="docutils literal notranslate"><span class="pre">MediaType.MESSAGEPACK</span></code>:</p>
<div class="sd-tab-set docutils">
<input id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="3.8" for="sd-tab-item-0">
Python 3.8+</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span><span class="p">,</span> <span class="n">MediaType</span>
</span><span data-line="3">
</span><span data-line="4">
</span><span data-line="5"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/health-check&quot;</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">MESSAGEPACK</span><span class="p">)</span>
</span><span data-line="6"><span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span data-line="7">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
</div>
<input checked="checked" id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="3.9" for="sd-tab-item-1">
Python 3.9+</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span><span class="p">,</span> <span class="n">MediaType</span>
</span><span data-line="2">
</span><span data-line="3">
</span><span data-line="4"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/health-check&quot;</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">MESSAGEPACK</span><span class="p">)</span>
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span data-line="6">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span>
</span></pre></div>
</div>
</div>
</div>
</section>
<section id="plaintext-responses">
<h3>Plaintext responses<a class="headerlink" href="#plaintext-responses" title="Link to this heading">¶</a></h3>
<p>For <code class="docutils literal notranslate"><span class="pre">MediaType.TEXT</span></code>, route handlers should return a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span><span class="p">,</span> <span class="n">MediaType</span>
</span><span data-line="2">
</span><span data-line="3">
</span><span data-line="4"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/health-check&quot;</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="6">    <span class="k">return</span> <span class="s2">&quot;healthy&quot;</span>
</span></pre></div>
</div>
</section>
<section id="html-responses">
<h3>HTML responses<a class="headerlink" href="#html-responses" title="Link to this heading">¶</a></h3>
<p>For <code class="docutils literal notranslate"><span class="pre">MediaType.HTML</span></code>, route handlers should return a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> value that contains HTML:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span><span class="p">,</span> <span class="n">MediaType</span>
</span><span data-line="2">
</span><span data-line="3">
</span><span data-line="4"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/page&quot;</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">HTML</span><span class="p">)</span>
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="6">    <span class="k">return</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span data-line="7"><span class="s2">    &lt;html&gt;</span>
</span><span data-line="8"><span class="s2">        &lt;body&gt;</span>
</span><span data-line="9"><span class="s2">            &lt;div&gt;</span>
</span><span data-line="10"><span class="s2">                &lt;span&gt;Hello World!&lt;/span&gt;</span>
</span><span data-line="11"><span class="s2">            &lt;/div&gt;</span>
</span><span data-line="12"><span class="s2">        &lt;/body&gt;</span>
</span><span data-line="13"><span class="s2">    &lt;/html&gt;</span>
</span><span data-line="14"><span class="s2">    &quot;&quot;&quot;</span>
</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It’s a good idea to use a <a class="reference internal" href="templating.html#template-engines"><span class="std std-ref">template engine</span></a> for more complex HTML responses
and to write the template itself in a separate file rather than a string.</p>
</div>
</section>
</section>
<section id="content-negotiation">
<h2>Content Negotiation<a class="headerlink" href="#content-negotiation" title="Link to this heading">¶</a></h2>
<p>If your handler can return data with different media types and you want to use
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Content_negotiation">Content Negotiation</a>
to allow the client to choose which type to return, you can use the
<a class="reference internal" href="../reference/connection.html#litestar.connection.Request.accept" title="litestar.connection.Request.accept"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Request.accept</span></code></a> property to
calculate the best matching return media type.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">MediaType</span><span class="p">,</span> <span class="n">Request</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="2">
</span><span data-line="3">
</span><span data-line="4"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/resource&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="5"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
</span><span data-line="6">    <span class="n">provided_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">MediaType</span><span class="o">.</span><span class="n">HTML</span><span class="p">,</span> <span class="s2">&quot;application/xml&quot;</span><span class="p">]</span>
</span><span data-line="7">    <span class="n">preferred_type</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">accept</span><span class="o">.</span><span class="n">best_match</span><span class="p">(</span><span class="n">provided_types</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">)</span>
</span><span data-line="8">
</span><span data-line="9">    <span class="n">content</span> <span class="o">=</span> <span class="kc">None</span>
</span><span data-line="10">    <span class="k">if</span> <span class="n">preferred_type</span> <span class="o">==</span> <span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">:</span>
</span><span data-line="11">        <span class="n">content</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello World!&quot;</span>
</span><span data-line="12">    <span class="k">elif</span> <span class="n">preferred_type</span> <span class="o">==</span> <span class="n">MediaType</span><span class="o">.</span><span class="n">HTML</span><span class="p">:</span>
</span><span data-line="13">        <span class="n">content</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&lt;h1&gt;Hello World!&lt;/h1&gt;&quot;</span>
</span><span data-line="14">    <span class="k">elif</span> <span class="n">preferred_type</span> <span class="o">==</span> <span class="s2">&quot;application/xml&quot;</span><span class="p">:</span>
</span><span data-line="15">        <span class="n">content</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&lt;xml&gt;&lt;msg&gt;Hello World!&lt;/msg&gt;&lt;/xml&gt;&quot;</span>
</span><span data-line="16">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="n">preferred_type</span><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18">
</span><span data-line="19"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">])</span>
</span></pre></div>
</div>
<div class="admonition">
<p class="admonition-title">Run it</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span data-line="1">&gt;<span class="w"> </span>curl<span class="w"> </span>http://127.0.0.1:8000/resource
</span><span data-line="2">Hello<span class="w"> </span>World!
</span><span data-line="3">&gt;<span class="w"> </span>curl<span class="w"> </span>http://127.0.0.1:8000/resource<span class="w"> </span>-H<span class="w"> </span>Accept:<span class="w"> </span>text/html
</span><span data-line="4">&lt;h1&gt;Hello<span class="w"> </span>World!&lt;/h1&gt;
</span><span data-line="5">&gt;<span class="w"> </span>curl<span class="w"> </span>http://127.0.0.1:8000/resource<span class="w"> </span>-H<span class="w"> </span>Accept:<span class="w"> </span>application/xml
</span><span data-line="6">&lt;xml&gt;&lt;msg&gt;Hello<span class="w"> </span>World!&lt;/msg&gt;&lt;/xml&gt;
</span></pre></div>
</div>
</div>
</section>
<section id="status-codes">
<h2>Status Codes<a class="headerlink" href="#status-codes" title="Link to this heading">¶</a></h2>
<p>You can control the response <code class="docutils literal notranslate"><span class="pre">status_code</span></code> by setting the corresponding kwarg to the desired value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.status_codes</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTTP_202_ACCEPTED</span>
</span><span data-line="4">
</span><span data-line="5">
</span><span data-line="6"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="7">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="8">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="9">
</span><span data-line="10">
</span><span data-line="11"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/resources&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="n">HTTP_202_ACCEPTED</span><span class="p">)</span>
</span><span data-line="12"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Resource</span><span class="p">:</span>
</span><span data-line="13">    <span class="k">return</span> <span class="n">Resource</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">status_code</span></code> is not set by the user, the following defaults are used:</p>
<ul class="simple">
<li><p>POST: 201 (Created)</p></li>
<li><p>DELETE: 204 (No Content)</p></li>
<li><p>GET, PATCH, PUT: 200 (Ok)</p></li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>For status codes &lt; 100 or 204, 304 statuses, no response body is allowed. If you specify a return annotation other
than <code class="docutils literal notranslate"><span class="pre">None</span></code>, an <a class="reference internal" href="../reference/exceptions.html#litestar.exceptions.ImproperlyConfiguredException" title="litestar.exceptions.ImproperlyConfiguredException"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImproperlyConfiguredException</span></code></a> will be raised.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using the <code class="docutils literal notranslate"><span class="pre">route</span></code> decorator with multiple http methods, the default status code is <code class="docutils literal notranslate"><span class="pre">200</span></code>.
The default for <code class="docutils literal notranslate"><span class="pre">delete</span></code> is <code class="docutils literal notranslate"><span class="pre">204</span></code> because by default it is assumed that delete operations return no data.
This though might not be the case in your implementation - so take care of setting it as you see fit.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>While you can write integers as the value for <code class="docutils literal notranslate"><span class="pre">status_code</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">200</span></code>, it’s best practice to use constants (also in
tests). Litestar includes easy to use statuses that are exported from <code class="docutils literal notranslate"><span class="pre">litestar.status_codes</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">HTTP_200_OK</span></code>
and <code class="docutils literal notranslate"><span class="pre">HTTP_201_CREATED</span></code>. Another option is the <a class="reference external" href="https://docs.python.org/3/library/http.html#http.HTTPStatus" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">http.HTTPStatus</span></code></a> enum from the standard library, which also offers
extra functionality.</p>
</div>
</section>
<section id="returning-responses">
<h2>Returning responses<a class="headerlink" href="#returning-responses" title="Link to this heading">¶</a></h2>
<p>While the default response handling fits most use cases, in some cases you need to be able to return a response instance
directly.</p>
<p>Litestar allows you to return any class inheriting from the <a class="reference internal" href="../reference/response/index.html#litestar.response.Response" title="litestar.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a> class. Thus, the below
example will work perfectly fine:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cookie</span>
</span><span data-line="5">
</span><span data-line="6">
</span><span data-line="7"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="8">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="9">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="10">
</span><span data-line="11">
</span><span data-line="12"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/resources&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="13"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span data-line="14">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="15">        <span class="n">Resource</span><span class="p">(</span>
</span><span data-line="16">            <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="17">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">,</span>
</span><span data-line="18">        <span class="p">),</span>
</span><span data-line="19">        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;MY-HEADER&quot;</span><span class="p">:</span> <span class="s2">&quot;xyz&quot;</span><span class="p">},</span>
</span><span data-line="20">        <span class="n">cookies</span><span class="o">=</span><span class="p">[</span><span class="n">Cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;my-cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;abc&quot;</span><span class="p">)],</span>
</span><span data-line="21">    <span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23">
</span><span data-line="24"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">])</span>
</span></pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>In the case of the builtin <a class="reference internal" href="../reference/response/index.html#litestar.response.Template" title="litestar.response.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code></a>,
<a class="reference internal" href="../reference/response/index.html#litestar.response.File" title="litestar.response.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>, <a class="reference internal" href="../reference/response/index.html#litestar.response.Stream" title="litestar.response.Stream"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></a>, and
<a class="reference internal" href="../reference/response/index.html#litestar.response.Redirect" title="litestar.response.Redirect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Redirect</span></code></a> you should use the response “response containers”, otherwise
OpenAPI documentation will not be generated correctly. For more details see the respective documentation sections:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#template-responses">Template responses</a></p></li>
<li><p><a class="reference internal" href="#file-responses">File responses</a></p></li>
<li><p><a class="reference internal" href="#streaming-responses">Streaming responses</a></p></li>
<li><p><a class="reference internal" href="#redirect-responses">Redirect responses</a></p></li>
</ul>
</div>
<section id="annotating-responses">
<h3>Annotating responses<a class="headerlink" href="#annotating-responses" title="Link to this heading">¶</a></h3>
<p>As you can see above, the <a class="reference internal" href="../reference/response/index.html#litestar.response.Response" title="litestar.response.Response"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a> class accepts a generic argument. This allows Litestar
to infer the response body when generating the OpenAPI docs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the generic argument is not provided, and thus defaults to <code class="docutils literal notranslate"><span class="pre">Any</span></code>, the OpenAPI docs will be imprecise. So make sure
to type this argument even when returning an empty or <code class="docutils literal notranslate"><span class="pre">null</span></code> body, i.e. use <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div>
</section>
<section id="returning-asgi-applications">
<h3>Returning ASGI Applications<a class="headerlink" href="#returning-asgi-applications" title="Link to this heading">¶</a></h3>
<p>Litestar also supports returning ASGI applications directly, as you would responses. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ASGIApp</span><span class="p">,</span> <span class="n">Receive</span><span class="p">,</span> <span class="n">Scope</span><span class="p">,</span> <span class="n">Send</span>
</span><span data-line="3">
</span><span data-line="4">
</span><span data-line="5"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
</span><span data-line="6"><span class="k">def</span><span class="w"> </span><span class="nf">handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ASGIApp</span><span class="p">:</span>
</span><span data-line="7">    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_asgi_app</span><span class="p">(</span><span class="n">scope</span><span class="p">:</span> <span class="n">Scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">Receive</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">Send</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>
</span><span data-line="8">
</span><span data-line="9">    <span class="k">return</span> <span class="n">my_asgi_app</span>
</span></pre></div>
</div>
<section id="what-is-an-asgi-application">
<h4>What is an ASGI Application?<a class="headerlink" href="#what-is-an-asgi-application" title="Link to this heading">¶</a></h4>
<p>An ASGI application in this context is any async callable (function, class method or simply a class that implements
that special <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__call__" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">object.__call__()</span></code></a> dunder method) that accepts the three ASGI arguments: <code class="docutils literal notranslate"><span class="pre">scope</span></code>, <code class="docutils literal notranslate"><span class="pre">receive</span></code>, and
<code class="docutils literal notranslate"><span class="pre">send</span></code>.</p>
<p>For example, all the following examples are ASGI applications:</p>
<section id="function-asgi-application">
<h5>Function ASGI Application<a class="headerlink" href="#function-asgi-application" title="Link to this heading">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Receive</span><span class="p">,</span> <span class="n">Scope</span><span class="p">,</span> <span class="n">Send</span>
</span><span data-line="2">
</span><span data-line="3">
</span><span data-line="4"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_asgi_app_function</span><span class="p">(</span><span class="n">scope</span><span class="p">:</span> <span class="n">Scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">Receive</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">Send</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="5">    <span class="c1"># do something here</span>
</span><span data-line="6">    <span class="o">...</span>
</span></pre></div>
</div>
</section>
<section id="method-asgi-application">
<h5>Method ASGI Application<a class="headerlink" href="#method-asgi-application" title="Link to this heading">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Receive</span><span class="p">,</span> <span class="n">Scope</span><span class="p">,</span> <span class="n">Send</span>
</span><span data-line="2">
</span><span data-line="3">
</span><span data-line="4"><span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">:</span>
</span><span data-line="5">    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_asgi_app_method</span><span class="p">(</span>
</span><span data-line="6">        <span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">Scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">Receive</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">Send</span>
</span><span data-line="7">    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="8">        <span class="c1"># do something here</span>
</span><span data-line="9">        <span class="o">...</span>
</span></pre></div>
</div>
</section>
<section id="class-asgi-application">
<h5>Class ASGI Application<a class="headerlink" href="#class-asgi-application" title="Link to this heading">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Receive</span><span class="p">,</span> <span class="n">Scope</span><span class="p">,</span> <span class="n">Send</span>
</span><span data-line="2">
</span><span data-line="3">
</span><span data-line="4"><span class="k">class</span><span class="w"> </span><span class="nc">ASGIApp</span><span class="p">:</span>
</span><span data-line="5">    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span> <span class="n">Scope</span><span class="p">,</span> <span class="n">receive</span><span class="p">:</span> <span class="n">Receive</span><span class="p">,</span> <span class="n">send</span><span class="p">:</span> <span class="n">Send</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="6">        <span class="c1"># do something here</span>
</span><span data-line="7">        <span class="o">...</span>
</span></pre></div>
</div>
</section>
</section>
<section id="returning-responses-from-third-party-libraries">
<h4>Returning responses from third party libraries<a class="headerlink" href="#returning-responses-from-third-party-libraries" title="Link to this heading">¶</a></h4>
<p>Because you can return any ASGI Application from a route handler, you can also use any ASGI application from other
libraries. For example, you can return the response classes from Starlette or FastAPI directly from route handlers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">starlette.responses</span><span class="w"> </span><span class="kn">import</span> <span class="n">JSONResponse</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ASGIApp</span>
</span><span data-line="5">
</span><span data-line="6">
</span><span data-line="7"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
</span><span data-line="8"><span class="k">def</span><span class="w"> </span><span class="nf">handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ASGIApp</span><span class="p">:</span>
</span><span data-line="9">    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span><span class="p">})</span>  <span class="c1"># type: ignore</span>
</span></pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Litestar offers strong typing for the ASGI arguments. Other libraries often offer less strict typing, which might
cause type checkers to complain when using ASGI apps from them inside Litestar.
For the time being, the only solution is to add <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">type:</span> <span class="pre">ignore</span></code> comments in the pertinent places.
Nonetheless, the above example will work perfectly fine.</p>
</div>
</section>
</section>
</section>
<section id="setting-response-headers">
<h2>Setting Response Headers<a class="headerlink" href="#setting-response-headers" title="Link to this heading">¶</a></h2>
<p>Litestar allows you to define response headers by using the <code class="docutils literal notranslate"><span class="pre">response_headers</span></code> kwarg. This kwarg is
available on all layers of the app - individual route handlers, controllers, routers, and the app
itself:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Controller</span><span class="p">,</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">MediaType</span><span class="p">,</span> <span class="n">Router</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResponseHeader</span>
</span><span data-line="3">
</span><span data-line="4">
</span><span data-line="5"><span class="k">class</span><span class="w"> </span><span class="nc">MyController</span><span class="p">(</span><span class="n">Controller</span><span class="p">):</span>
</span><span data-line="6">    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/controller-path&quot;</span>
</span><span data-line="7">    <span class="n">response_headers</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="8">        <span class="n">ResponseHeader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;controller-level-header&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;controller header&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;controller level header&quot;</span><span class="p">)</span>
</span><span data-line="9">    <span class="p">]</span>
</span><span data-line="10">
</span><span data-line="11">    <span class="nd">@get</span><span class="p">(</span>
</span><span data-line="12">        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/handler-path&quot;</span><span class="p">,</span>
</span><span data-line="13">        <span class="n">response_headers</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="14">            <span class="n">ResponseHeader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my-local-header&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;local header&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;local level header&quot;</span><span class="p">)</span>
</span><span data-line="15">        <span class="p">],</span>
</span><span data-line="16">        <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span>
</span><span data-line="17">        <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="18">    <span class="p">)</span>
</span><span data-line="19">    <span class="k">def</span><span class="w"> </span><span class="nf">my_route_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="20">        <span class="k">return</span> <span class="s2">&quot;hello world&quot;</span>
</span><span data-line="21">
</span><span data-line="22">
</span><span data-line="23"><span class="n">router</span> <span class="o">=</span> <span class="n">Router</span><span class="p">(</span>
</span><span data-line="24">    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/router-path&quot;</span><span class="p">,</span>
</span><span data-line="25">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">MyController</span><span class="p">],</span>
</span><span data-line="26">    <span class="n">response_headers</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="27">        <span class="n">ResponseHeader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;router-level-header&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;router header&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;router level header&quot;</span><span class="p">)</span>
</span><span data-line="28">    <span class="p">],</span>
</span><span data-line="29"><span class="p">)</span>
</span><span data-line="30">
</span><span data-line="31"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span>
</span><span data-line="32">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">router</span><span class="p">],</span>
</span><span data-line="33">    <span class="n">response_headers</span><span class="o">=</span><span class="p">[</span><span class="n">ResponseHeader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;app-level-header&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;app header&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;app level header&quot;</span><span class="p">)],</span>
</span><span data-line="34"><span class="p">)</span>
</span></pre></div>
</div>
<p>In the above example the response returned from <code class="docutils literal notranslate"><span class="pre">my_route_handler</span></code> will have headers set from each layer of the
application using the given key+value combinations. I.e. it will be a dictionary equal to this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="p">{</span>
</span><span data-line="2"><span class="w">  </span><span class="nt">&quot;my-local-header&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;local header&quot;</span><span class="p">,</span>
</span><span data-line="3"><span class="w">  </span><span class="nt">&quot;controller-level-header&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;controller header&quot;</span><span class="p">,</span>
</span><span data-line="4"><span class="w">  </span><span class="nt">&quot;router-level-header&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;router header&quot;</span><span class="p">,</span>
</span><span data-line="5"><span class="w">  </span><span class="nt">&quot;app-level-header&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;app header&quot;</span>
</span><span data-line="6"><span class="p">}</span>
</span></pre></div>
</div>
<p>The respective descriptions will be used for the OpenAPI documentation.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a class="reference internal" href="../reference/datastructures/index.html#litestar.datastructures.ResponseHeader" title="litestar.datastructures.response_header.ResponseHeader"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResponseHeader</span></code></a> is
a special class that allows to add OpenAPI attributes such as <cite>description</cite> or <cite>documentation_only</cite>.
If you don’t need those, you can optionally define <cite>response_headers</cite> using a mapping - such as a dictionary -
as well:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@get</span><span class="p">(</span><span class="n">response_headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;my-header&quot;</span><span class="p">:</span> <span class="s2">&quot;header-value&quot;</span><span class="p">})</span>
</span><span data-line="2"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span> <span class="o">...</span>
</span></pre></div>
</div>
</div>
<section id="setting-headers-dynamically">
<h3>Setting Headers Dynamically<a class="headerlink" href="#setting-headers-dynamically" title="Link to this heading">¶</a></h3>
<p>The above detailed scheme works great for statically configured headers, but how would you go about handling dynamically
setting headers? Litestar allows you to set headers dynamically in several ways and below we will detail the two
primary patterns.</p>
<section id="using-annotated-responses">
<h4>Using Annotated Responses<a class="headerlink" href="#using-annotated-responses" title="Link to this heading">¶</a></h4>
<p>We can simply return a response instance directly from the route handler and set the headers dictionary manually
as you see fit, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">randint</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResponseHeader</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="10">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="11">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="nd">@get</span><span class="p">(</span>
</span><span data-line="15">    <span class="s2">&quot;/resources&quot;</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">response_headers</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="17">        <span class="n">ResponseHeader</span><span class="p">(</span>
</span><span data-line="18">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 1 - 100&quot;</span><span class="p">,</span> <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span>
</span><span data-line="19">        <span class="p">)</span>
</span><span data-line="20">    <span class="p">],</span>
</span><span data-line="21">    <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="22"><span class="p">)</span>
</span><span data-line="23"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span data-line="24">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="25">        <span class="n">Resource</span><span class="p">(</span>
</span><span data-line="26">            <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="27">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">,</span>
</span><span data-line="28">        <span class="p">),</span>
</span><span data-line="29">        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))},</span>
</span><span data-line="30">    <span class="p">)</span>
</span><span data-line="31">
</span><span data-line="32">
</span><span data-line="33"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">])</span>
</span></pre></div>
</div>
<p>In the above we use the <code class="docutils literal notranslate"><span class="pre">response_headers</span></code> kwarg to pass the <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">description</span></code> parameters for the <code class="docutils literal notranslate"><span class="pre">Random-Header</span></code>
to the OpenAPI documentation, but we set the value dynamically in as part of
the <a class="reference internal" href="#annotating-responses"><span class="std std-ref">annotated response</span></a> we return. To this end we do not set a <code class="docutils literal notranslate"><span class="pre">value</span></code>
for it and we designate it as <code class="docutils literal notranslate"><span class="pre">documentation_only=True</span></code>.</p>
</section>
<section id="using-the-after-request-hook">
<h4>Using the After Request Hook<a class="headerlink" href="#using-the-after-request-hook" title="Link to this heading">¶</a></h4>
<p>An alternative pattern would be to use an <a class="reference internal" href="lifecycle-hooks.html#after-request"><span class="std std-ref">after request handler</span></a>. We can define
the handler on different layers of the application as explained in the pertinent docs. We should take care to document
the headers on the corresponding layer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">randint</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">Router</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResponseHeader</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="10">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="11">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="nd">@get</span><span class="p">(</span>
</span><span data-line="15">    <span class="s2">&quot;/resources&quot;</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">response_headers</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="17">        <span class="n">ResponseHeader</span><span class="p">(</span>
</span><span data-line="18">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">,</span>
</span><span data-line="19">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 100 - 1000&quot;</span><span class="p">,</span>
</span><span data-line="20">            <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21">        <span class="p">)</span>
</span><span data-line="22">    <span class="p">],</span>
</span><span data-line="23">    <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="24"><span class="p">)</span>
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span data-line="26">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="27">        <span class="n">Resource</span><span class="p">(</span>
</span><span data-line="28">            <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="29">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">,</span>
</span><span data-line="30">        <span class="p">),</span>
</span><span data-line="31">        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))},</span>
</span><span data-line="32">    <span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34">
</span><span data-line="35"><span class="k">def</span><span class="w"> </span><span class="nf">after_request_handler</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="n">Response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
</span><span data-line="36">    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))})</span>
</span><span data-line="37">    <span class="k">return</span> <span class="n">response</span>
</span><span data-line="38">
</span><span data-line="39">
</span><span data-line="40"><span class="n">router</span> <span class="o">=</span> <span class="n">Router</span><span class="p">(</span>
</span><span data-line="41">    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/router-path&quot;</span><span class="p">,</span>
</span><span data-line="42">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">],</span>
</span><span data-line="43">    <span class="n">after_request</span><span class="o">=</span><span class="n">after_request_handler</span><span class="p">,</span>
</span><span data-line="44">    <span class="n">response_headers</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="45">        <span class="n">ResponseHeader</span><span class="p">(</span>
</span><span data-line="46">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">,</span>
</span><span data-line="47">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 1 - 100&quot;</span><span class="p">,</span>
</span><span data-line="48">            <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="49">        <span class="p">)</span>
</span><span data-line="50">    <span class="p">],</span>
</span><span data-line="51"><span class="p">)</span>
</span><span data-line="52">
</span><span data-line="53">
</span><span data-line="54"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">router</span><span class="p">])</span>
</span></pre></div>
</div>
<p>In the above we set the response header using an <code class="docutils literal notranslate"><span class="pre">after_request_handler</span></code> function on the router level. Because the
handler function is applied on the router, we also set the documentation for it on the router.</p>
<p>We can use this pattern to fine-tune the OpenAPI documentation more granularly by overriding header specification as
required. For example, lets say we have a router level header being set and a local header with the same key but a
different value range:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">randint</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">Router</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResponseHeader</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="10">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="11">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="nd">@get</span><span class="p">(</span>
</span><span data-line="15">    <span class="s2">&quot;/resources&quot;</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">response_headers</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="17">        <span class="n">ResponseHeader</span><span class="p">(</span>
</span><span data-line="18">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">,</span>
</span><span data-line="19">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 100 - 1000&quot;</span><span class="p">,</span>
</span><span data-line="20">            <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21">        <span class="p">)</span>
</span><span data-line="22">    <span class="p">],</span>
</span><span data-line="23">    <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="24"><span class="p">)</span>
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span data-line="26">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="27">        <span class="n">Resource</span><span class="p">(</span>
</span><span data-line="28">            <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="29">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">,</span>
</span><span data-line="30">        <span class="p">),</span>
</span><span data-line="31">        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))},</span>
</span><span data-line="32">    <span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34">
</span><span data-line="35"><span class="k">def</span><span class="w"> </span><span class="nf">after_request_handler</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="n">Response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
</span><span data-line="36">    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))})</span>
</span><span data-line="37">    <span class="k">return</span> <span class="n">response</span>
</span><span data-line="38">
</span><span data-line="39">
</span><span data-line="40"><span class="n">router</span> <span class="o">=</span> <span class="n">Router</span><span class="p">(</span>
</span><span data-line="41">    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/router-path&quot;</span><span class="p">,</span>
</span><span data-line="42">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">],</span>
</span><span data-line="43">    <span class="n">after_request</span><span class="o">=</span><span class="n">after_request_handler</span><span class="p">,</span>
</span><span data-line="44">    <span class="n">response_headers</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="45">        <span class="n">ResponseHeader</span><span class="p">(</span>
</span><span data-line="46">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Random-Header&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 1 - 100&quot;</span><span class="p">,</span> <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span>
</span><span data-line="47">        <span class="p">)</span>
</span><span data-line="48">    <span class="p">],</span>
</span><span data-line="49"><span class="p">)</span>
</span><span data-line="50">
</span><span data-line="51"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">router</span><span class="p">])</span>
</span></pre></div>
</div>
</section>
</section>
<section id="predefined-headers">
<h3>Predefined Headers<a class="headerlink" href="#predefined-headers" title="Link to this heading">¶</a></h3>
<p>Litestar has a dedicated implementation for a few commonly used headers. These headers can be set separately
with dedicated keyword arguments or as class attributes on all layers of the app (individual route handlers, controllers,
routers, and the app itself). Each layer overrides the layer above it - thus, the headers defined for a specific route
handler will override those defined on its router, which will in turn override those defined on the app level.</p>
<p>These header implementations allow easy creating, serialization and parsing according to the associated header
specifications.</p>
<section id="cache-control">
<h4>Cache Control<a class="headerlink" href="#cache-control" title="Link to this heading">¶</a></h4>
<p><a class="reference internal" href="../reference/datastructures/index.html#litestar.datastructures.CacheControlHeader" title="litestar.datastructures.headers.CacheControlHeader"><code class="xref py py-class docutils literal notranslate"><span class="pre">CacheControlHeader</span></code></a> represents a
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control">Cache-Control Header</a>.</p>
<p>Here is a simple example that shows how to use it:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Cache Control Header</span><a class="headerlink" href="#id4" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Controller</span><span class="p">,</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">CacheControlHeader</span>
</span><span data-line="5">
</span><span data-line="6">
</span><span data-line="7"><span class="k">class</span><span class="w"> </span><span class="nc">MyController</span><span class="p">(</span><span class="n">Controller</span><span class="p">):</span>
</span><span data-line="8">    <span class="n">cache_control</span> <span class="o">=</span> <span class="n">CacheControlHeader</span><span class="p">(</span><span class="n">max_age</span><span class="o">=</span><span class="mi">86_400</span><span class="p">,</span> <span class="n">public</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="9">
</span><span data-line="10">    <span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/chance_of_rain&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="11">    <span class="k">def</span><span class="w"> </span><span class="nf">get_chance_of_rain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span data-line="12"><span class="w">        </span><span class="sd">&quot;&quot;&quot;This endpoint uses the cache control value defined in the controller which overrides the app value.&quot;&quot;&quot;</span>
</span><span data-line="13">        <span class="k">return</span> <span class="mf">0.5</span>
</span><span data-line="14">
</span><span data-line="15">    <span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/timestamp&quot;</span><span class="p">,</span> <span class="n">cache_control</span><span class="o">=</span><span class="n">CacheControlHeader</span><span class="p">(</span><span class="n">no_store</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="16">    <span class="k">def</span><span class="w"> </span><span class="nf">get_server_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span data-line="17"><span class="w">        </span><span class="sd">&quot;&quot;&quot;This endpoint overrides the cache control value defined in the controller.&quot;&quot;&quot;</span>
</span><span data-line="18">        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span data-line="19">
</span><span data-line="20">
</span><span data-line="21"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/population&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="22"><span class="k">def</span><span class="w"> </span><span class="nf">get_population_count</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="23"><span class="w">    </span><span class="sd">&quot;&quot;&quot;This endpoint will use the cache control defined in the app.&quot;&quot;&quot;</span>
</span><span data-line="24">    <span class="k">return</span> <span class="mi">100000</span>
</span><span data-line="25">
</span><span data-line="26">
</span><span data-line="27"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span>
</span><span data-line="28">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">MyController</span><span class="p">,</span> <span class="n">get_population_count</span><span class="p">],</span>
</span><span data-line="29">    <span class="n">cache_control</span><span class="o">=</span><span class="n">CacheControlHeader</span><span class="p">(</span><span class="n">max_age</span><span class="o">=</span><span class="mi">2_628_288</span><span class="p">,</span> <span class="n">public</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span data-line="30"><span class="p">)</span>
</span></pre></div>
</div>
</div>
<p>In this example we have a <code class="docutils literal notranslate"><span class="pre">cache-control</span></code> with <code class="docutils literal notranslate"><span class="pre">max-age</span></code> of 1 month for the whole app, a <code class="docutils literal notranslate"><span class="pre">max-age</span></code> of
1 day for all routes within <code class="docutils literal notranslate"><span class="pre">MyController</span></code>, and <code class="docutils literal notranslate"><span class="pre">no-store</span></code> for one specific route <code class="docutils literal notranslate"><span class="pre">get_server_time</span></code>. Here are the cache
control values that will be returned from each endpoint:</p>
<ul class="simple">
<li><p>When calling <code class="docutils literal notranslate"><span class="pre">/population</span></code> the response will have <code class="docutils literal notranslate"><span class="pre">cache-control</span></code> with <code class="docutils literal notranslate"><span class="pre">max-age=2628288</span></code> (1 month).</p></li>
<li><p>When calling <code class="docutils literal notranslate"><span class="pre">/chance_of_rain</span></code> the response will have <code class="docutils literal notranslate"><span class="pre">cache-control</span></code> with <code class="docutils literal notranslate"><span class="pre">max-age=86400</span></code> (1 day).</p></li>
<li><p>When calling <code class="docutils literal notranslate"><span class="pre">/timestamp</span></code> the response will have <code class="docutils literal notranslate"><span class="pre">cache-control</span></code> with <code class="docutils literal notranslate"><span class="pre">no-store</span></code> which means don’t store the result
in any cache.</p></li>
</ul>
</section>
<section id="etag">
<h4>ETag<a class="headerlink" href="#etag" title="Link to this heading">¶</a></h4>
<p><a class="reference internal" href="../reference/datastructures/index.html#litestar.datastructures.ETag" title="litestar.datastructures.headers.ETag"><code class="xref py py-class docutils literal notranslate"><span class="pre">ETag</span></code></a> represents an
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag">ETag header</a>.</p>
<p>Here are some usage examples:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Returning ETag headers</span><a class="headerlink" href="#id5" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span data-line="3">
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Controller</span><span class="p">,</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ETag</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">MediaType</span>
</span><span data-line="7"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">Response</span>
</span><span data-line="8">
</span><span data-line="9">
</span><span data-line="10"><span class="k">class</span><span class="w"> </span><span class="nc">MyController</span><span class="p">(</span><span class="n">Controller</span><span class="p">):</span>
</span><span data-line="11">    <span class="n">etag</span> <span class="o">=</span> <span class="n">ETag</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13">    <span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/chance_of_rain&quot;</span><span class="p">)</span>
</span><span data-line="14">    <span class="k">def</span><span class="w"> </span><span class="nf">get_chance_of_rain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span data-line="15"><span class="w">        </span><span class="sd">&quot;&quot;&quot;This endpoint uses the etag value in the controller which overrides the app value.</span>
</span><span data-line="16">
</span><span data-line="17"><span class="sd">        The returned header will be `etag: &quot;foo&quot;`</span>
</span><span data-line="18"><span class="sd">        &quot;&quot;&quot;</span>
</span><span data-line="19">        <span class="k">return</span> <span class="mf">0.5</span>
</span><span data-line="20">
</span><span data-line="21">    <span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/timestamp&quot;</span><span class="p">,</span> <span class="n">etag</span><span class="o">=</span><span class="n">ETag</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">))</span>
</span><span data-line="22">    <span class="k">def</span><span class="w"> </span><span class="nf">get_server_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span data-line="23"><span class="w">        </span><span class="sd">&quot;&quot;&quot;This endpoint overrides the etag defined in the controller.</span>
</span><span data-line="24">
</span><span data-line="25"><span class="sd">        The returned header will be `etag: W/&quot;bar&quot;`</span>
</span><span data-line="26"><span class="sd">        &quot;&quot;&quot;</span>
</span><span data-line="27">        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span data-line="28">
</span><span data-line="29">
</span><span data-line="30"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/population&quot;</span><span class="p">)</span>
</span><span data-line="31"><span class="k">def</span><span class="w"> </span><span class="nf">get_population_count</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="32"><span class="w">    </span><span class="sd">&quot;&quot;&quot;This endpoint will use the etag defined in the app.</span>
</span><span data-line="33">
</span><span data-line="34"><span class="sd">    The returned header will be `etag: &quot;bar&quot;`</span>
</span><span data-line="35"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="36">    <span class="k">return</span> <span class="mi">100000</span>
</span><span data-line="37">
</span><span data-line="38">
</span><span data-line="39"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/population-dynamic&quot;</span><span class="p">,</span> <span class="n">etag</span><span class="o">=</span><span class="n">ETag</span><span class="p">(</span><span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span data-line="40"><span class="k">def</span><span class="w"> </span><span class="nf">get_population_count_dynamic</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span data-line="41"><span class="w">    </span><span class="sd">&quot;&quot;&quot;The etag defined in this route handler will not be returned, and does not need a value.</span>
</span><span data-line="42">
</span><span data-line="43"><span class="sd">    It will only be used for OpenAPI generation.</span>
</span><span data-line="44"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="45">    <span class="n">population_count</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</span><span data-line="46">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="47">        <span class="n">content</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">population_count</span><span class="p">),</span>
</span><span data-line="48">        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;etag&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">population_count</span><span class="p">)},</span>
</span><span data-line="49">        <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span>
</span><span data-line="50">        <span class="n">status_code</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
</span><span data-line="51">    <span class="p">)</span>
</span><span data-line="52">
</span><span data-line="53">
</span><span data-line="54"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">MyController</span><span class="p">,</span> <span class="n">get_population_count</span><span class="p">],</span> <span class="n">etag</span><span class="o">=</span><span class="n">ETag</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">))</span>
</span></pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Parsing ETag headers</span><a class="headerlink" href="#id6" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ETag</span>
</span><span data-line="2">
</span><span data-line="3"><span class="k">assert</span> <span class="n">ETag</span><span class="o">.</span><span class="n">from_header</span><span class="p">(</span><span class="s1">&#39;&quot;foo&quot;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">ETag</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">)</span>
</span><span data-line="4"><span class="k">assert</span> <span class="n">ETag</span><span class="o">.</span><span class="n">from_header</span><span class="p">(</span><span class="s1">&#39;W/&quot;foo&quot;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">ETag</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">weak</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="setting-response-cookies">
<h2>Setting Response Cookies<a class="headerlink" href="#setting-response-cookies" title="Link to this heading">¶</a></h2>
<p>Litestar allows you to define response cookies by using the <code class="docutils literal notranslate"><span class="pre">response_cookies</span></code> kwarg. This kwarg is
available on all layers of the app - individual route handlers, controllers, routers, and the app
itself:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Controller</span><span class="p">,</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">MediaType</span><span class="p">,</span> <span class="n">Router</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cookie</span>
</span><span data-line="3">
</span><span data-line="4">
</span><span data-line="5"><span class="k">class</span><span class="w"> </span><span class="nc">MyController</span><span class="p">(</span><span class="n">Controller</span><span class="p">):</span>
</span><span data-line="6">    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/controller-path&quot;</span>
</span><span data-line="7">    <span class="n">response_cookies</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="8">        <span class="n">Cookie</span><span class="p">(</span>
</span><span data-line="9">            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;controller-cookie&quot;</span><span class="p">,</span>
</span><span data-line="10">            <span class="n">value</span><span class="o">=</span><span class="s2">&quot;controller value&quot;</span><span class="p">,</span>
</span><span data-line="11">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;controller level cookie&quot;</span><span class="p">,</span>
</span><span data-line="12">        <span class="p">)</span>
</span><span data-line="13">    <span class="p">]</span>
</span><span data-line="14">
</span><span data-line="15">    <span class="nd">@get</span><span class="p">(</span>
</span><span data-line="16">        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
</span><span data-line="17">        <span class="n">response_cookies</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="18">            <span class="n">Cookie</span><span class="p">(</span>
</span><span data-line="19">                <span class="n">key</span><span class="o">=</span><span class="s2">&quot;local-cookie&quot;</span><span class="p">,</span>
</span><span data-line="20">                <span class="n">value</span><span class="o">=</span><span class="s2">&quot;local value&quot;</span><span class="p">,</span>
</span><span data-line="21">                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;route handler level cookie&quot;</span><span class="p">,</span>
</span><span data-line="22">            <span class="p">)</span>
</span><span data-line="23">        <span class="p">],</span>
</span><span data-line="24">        <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span>
</span><span data-line="25">        <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="26">    <span class="p">)</span>
</span><span data-line="27">    <span class="k">def</span><span class="w"> </span><span class="nf">my_route_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="28">        <span class="k">return</span> <span class="s2">&quot;hello world&quot;</span>
</span><span data-line="29">
</span><span data-line="30">
</span><span data-line="31"><span class="n">router</span> <span class="o">=</span> <span class="n">Router</span><span class="p">(</span>
</span><span data-line="32">    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/router-path&quot;</span><span class="p">,</span>
</span><span data-line="33">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">MyController</span><span class="p">],</span>
</span><span data-line="34">    <span class="n">response_cookies</span><span class="o">=</span><span class="p">[</span><span class="n">Cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;router-cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;router value&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;router level cookie&quot;</span><span class="p">)],</span>
</span><span data-line="35"><span class="p">)</span>
</span><span data-line="36">
</span><span data-line="37"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span>
</span><span data-line="38">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">router</span><span class="p">],</span>
</span><span data-line="39">    <span class="n">response_cookies</span><span class="o">=</span><span class="p">[</span><span class="n">Cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;app-cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;app value&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;app level cookie&quot;</span><span class="p">)],</span>
</span><span data-line="40"><span class="p">)</span>
</span></pre></div>
</div>
<p>In the above example, the response returned by <code class="docutils literal notranslate"><span class="pre">my_route_handler</span></code> will have cookies set by each layer of the
application. Cookies are set using
the <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie">Set-Cookie header</a> and with above resulting
in:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span data-line="1">Set-Cookie: local-cookie=local value; Path=/; SameSite=lax
</span><span data-line="2">Set-Cookie: controller-cookie=controller value; Path=/; SameSite=lax
</span><span data-line="3">Set-Cookie: router-cookie=router value; Path=/; SameSite=lax
</span><span data-line="4">Set-Cookie: app-cookie=app value; Path=/; SameSite=lax
</span></pre></div>
</div>
<p>You can easily override cookies declared in higher levels by redeclaring a cookie with the same key in a lower level,
e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Controller</span><span class="p">,</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">MediaType</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cookie</span>
</span><span data-line="3">
</span><span data-line="4">
</span><span data-line="5"><span class="k">class</span><span class="w"> </span><span class="nc">MyController</span><span class="p">(</span><span class="n">Controller</span><span class="p">):</span>
</span><span data-line="6">    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/controller-path&quot;</span>
</span><span data-line="7">    <span class="n">response_cookies</span> <span class="o">=</span> <span class="p">[</span><span class="n">Cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;my-cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;123&quot;</span><span class="p">)]</span>
</span><span data-line="8">
</span><span data-line="9">    <span class="nd">@get</span><span class="p">(</span>
</span><span data-line="10">        <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/&quot;</span><span class="p">,</span>
</span><span data-line="11">        <span class="n">response_cookies</span><span class="o">=</span><span class="p">[</span><span class="n">Cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;my-cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;456&quot;</span><span class="p">)],</span>
</span><span data-line="12">        <span class="n">media_type</span><span class="o">=</span><span class="n">MediaType</span><span class="o">.</span><span class="n">TEXT</span><span class="p">,</span>
</span><span data-line="13">        <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="14">    <span class="p">)</span>
</span><span data-line="15">    <span class="k">def</span><span class="w"> </span><span class="nf">my_route_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span data-line="16">        <span class="k">return</span> <span class="s2">&quot;hello world&quot;</span>
</span><span data-line="17">
</span><span data-line="18">
</span><span data-line="19"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">MyController</span><span class="p">])</span>
</span></pre></div>
</div>
<p>Of the two declarations of <code class="docutils literal notranslate"><span class="pre">my-cookie</span></code> only the route handler one will be used, because its lower level:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><span data-line="1">Set-Cookie: my-cookie=456; Path=/; SameSite=lax
</span></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If all you need for your cookies are key and value, you can supply them using a <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping[str,</span> <span class="pre">str]</span></code></a>
- like a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> - instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="nd">@get</span><span class="p">(</span><span class="n">response_cookies</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;my-cookie&quot;</span><span class="p">:</span> <span class="s2">&quot;cookie-value&quot;</span><span class="p">})</span>
</span><span data-line="2"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span> <span class="o">...</span>
</span></pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="../reference/datastructures/index.html#litestar.datastructures.Cookie" title="litestar.datastructures.cookie.Cookie"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cookie</span> <span class="pre">reference</span></code></a></p></li>
</ul>
</div>
<section id="setting-cookies-dynamically">
<h3>Setting Cookies dynamically<a class="headerlink" href="#setting-cookies-dynamically" title="Link to this heading">¶</a></h3>
<p>While the above scheme works great for static cookie values, it doesn’t allow for dynamic cookies. Because cookies are
fundamentally a type of response header, we can utilize the same patterns we use to
setting <a class="reference internal" href="#setting-headers-dynamically"><span class="std std-ref">set headers headers</span></a>.</p>
<section id="id2">
<h4>Using Annotated Responses<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<p>We can simply return a response instance directly from the route handler and set the cookies list manually
as you see fit, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">randint</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cookie</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="10">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="11">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="nd">@get</span><span class="p">(</span>
</span><span data-line="15">    <span class="s2">&quot;/resources&quot;</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">response_cookies</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="17">        <span class="n">Cookie</span><span class="p">(</span>
</span><span data-line="18">            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;Random-Cookie&quot;</span><span class="p">,</span>
</span><span data-line="19">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 1 - 100&quot;</span><span class="p">,</span>
</span><span data-line="20">            <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21">        <span class="p">)</span>
</span><span data-line="22">    <span class="p">],</span>
</span><span data-line="23">    <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="24"><span class="p">)</span>
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span data-line="26">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="27">        <span class="n">Resource</span><span class="p">(</span>
</span><span data-line="28">            <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="29">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">,</span>
</span><span data-line="30">        <span class="p">),</span>
</span><span data-line="31">        <span class="n">cookies</span><span class="o">=</span><span class="p">[</span><span class="n">Cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;Random-Cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)))],</span>
</span><span data-line="32">    <span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34">
</span><span data-line="35"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">])</span>
</span></pre></div>
</div>
<p>In the above we use the <code class="docutils literal notranslate"><span class="pre">response_cookies</span></code> kwarg to pass the <code class="docutils literal notranslate"><span class="pre">key</span></code> and <code class="docutils literal notranslate"><span class="pre">description</span></code> parameters for the <code class="docutils literal notranslate"><span class="pre">Random-Cookie</span></code>
to the OpenAPI documentation, but we set the value dynamically in as part of
the <a class="reference internal" href="#annotating-responses"><span class="std std-ref">annotated response</span></a> we return. To this end we do not set a <code class="docutils literal notranslate"><span class="pre">value</span></code>
for it and we designate it as <code class="docutils literal notranslate"><span class="pre">documentation_only=True</span></code>.</p>
</section>
<section id="id3">
<h4>Using the After Request Hook<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<p>An alternative pattern would be to use an <a class="reference internal" href="lifecycle-hooks.html#after-request"><span class="std std-ref">after request handler</span></a>. We can define
the handler on different layers of the application as explained in the pertinent docs. We should take care to document
the cookies on the corresponding layer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">randint</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">Router</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cookie</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="10">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="11">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/resources&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="15"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Resource</span><span class="p">:</span>
</span><span data-line="16">    <span class="k">return</span> <span class="n">Resource</span><span class="p">(</span>
</span><span data-line="17">        <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="18">        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">,</span>
</span><span data-line="19">    <span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21">
</span><span data-line="22"><span class="k">def</span><span class="w"> </span><span class="nf">after_request_handler</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="n">Response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
</span><span data-line="23">    <span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;Random-Cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)))</span>
</span><span data-line="24">    <span class="k">return</span> <span class="n">response</span>
</span><span data-line="25">
</span><span data-line="26">
</span><span data-line="27"><span class="n">router</span> <span class="o">=</span> <span class="n">Router</span><span class="p">(</span>
</span><span data-line="28">    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/router-path&quot;</span><span class="p">,</span>
</span><span data-line="29">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">],</span>
</span><span data-line="30">    <span class="n">after_request</span><span class="o">=</span><span class="n">after_request_handler</span><span class="p">,</span>
</span><span data-line="31">    <span class="n">response_cookies</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="32">        <span class="n">Cookie</span><span class="p">(</span>
</span><span data-line="33">            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;Random-Cookie&quot;</span><span class="p">,</span>
</span><span data-line="34">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 1 - 100&quot;</span><span class="p">,</span>
</span><span data-line="35">            <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="36">        <span class="p">)</span>
</span><span data-line="37">    <span class="p">],</span>
</span><span data-line="38"><span class="p">)</span>
</span><span data-line="39">
</span><span data-line="40"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">router</span><span class="p">])</span>
</span></pre></div>
</div>
<p>In the above we set the cookie using an <code class="docutils literal notranslate"><span class="pre">after_request_handler</span></code> function on the router level. Because the
handler function is applied on the router, we also set the documentation for it on the router.</p>
<p>We can use this pattern to fine-tune the OpenAPI documentation more granular by overriding cookie specification as
required. For example, lets say we have a router level cookie being set and a local cookie with the same key but a
different value range:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">randint</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">Router</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cookie</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">class</span><span class="w"> </span><span class="nc">Resource</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="10">    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="11">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="nd">@get</span><span class="p">(</span>
</span><span data-line="15">    <span class="s2">&quot;/resources&quot;</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">response_cookies</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="17">        <span class="n">Cookie</span><span class="p">(</span>
</span><span data-line="18">            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;Random-Cookie&quot;</span><span class="p">,</span>
</span><span data-line="19">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 100 - 1000&quot;</span><span class="p">,</span>
</span><span data-line="20">            <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21">        <span class="p">)</span>
</span><span data-line="22">    <span class="p">],</span>
</span><span data-line="23">    <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="24"><span class="p">)</span>
</span><span data-line="25"><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_resource</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="n">Resource</span><span class="p">]:</span>
</span><span data-line="26">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="27">        <span class="n">Resource</span><span class="p">(</span>
</span><span data-line="28">            <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="29">            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my resource&quot;</span><span class="p">,</span>
</span><span data-line="30">        <span class="p">),</span>
</span><span data-line="31">        <span class="n">cookies</span><span class="o">=</span><span class="p">[</span><span class="n">Cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;Random-Cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)))],</span>
</span><span data-line="32">    <span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34">
</span><span data-line="35"><span class="k">def</span><span class="w"> </span><span class="nf">after_request_handler</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="n">Response</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
</span><span data-line="36">    <span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;Random-Cookie&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)))</span>
</span><span data-line="37">    <span class="k">return</span> <span class="n">response</span>
</span><span data-line="38">
</span><span data-line="39">
</span><span data-line="40"><span class="n">router</span> <span class="o">=</span> <span class="n">Router</span><span class="p">(</span>
</span><span data-line="41">    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;/router-path&quot;</span><span class="p">,</span>
</span><span data-line="42">    <span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">retrieve_resource</span><span class="p">],</span>
</span><span data-line="43">    <span class="n">after_request</span><span class="o">=</span><span class="n">after_request_handler</span><span class="p">,</span>
</span><span data-line="44">    <span class="n">response_cookies</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="45">        <span class="n">Cookie</span><span class="p">(</span>
</span><span data-line="46">            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;Random-Cookie&quot;</span><span class="p">,</span>
</span><span data-line="47">            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;a random number in the range 1 - 100&quot;</span><span class="p">,</span>
</span><span data-line="48">            <span class="n">documentation_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="49">        <span class="p">)</span>
</span><span data-line="50">    <span class="p">],</span>
</span><span data-line="51"><span class="p">)</span>
</span><span data-line="52">
</span><span data-line="53"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">router</span><span class="p">])</span>
</span></pre></div>
</div>
</section>
</section>
</section>
<section id="redirect-responses">
<h2>Redirect Responses<a class="headerlink" href="#redirect-responses" title="Link to this heading">¶</a></h2>
<p>Redirect responses are <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Redirections">special HTTP responses</a> with a
status code in the 30x range.</p>
<p>In Litestar, a redirect response looks like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.status_codes</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTTP_302_FOUND</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">Redirect</span>
</span><span data-line="4">
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/some-path&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="n">HTTP_302_FOUND</span><span class="p">)</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">redirect</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Redirect</span><span class="p">:</span>
</span><span data-line="8">    <span class="c1"># do some stuff here</span>
</span><span data-line="9">    <span class="c1"># ...</span>
</span><span data-line="10">    <span class="c1"># finally return redirect</span>
</span><span data-line="11">    <span class="k">return</span> <span class="n">Redirect</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/other-path&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>To return a redirect response you should do the following:</p>
<ul class="simple">
<li><p>optionally: set an appropriate status code for the route handler (301, 302, 303, 307, 308). If not set the default of 302 will be used.</p></li>
<li><p>annotate the return value of the route handler as returning <a class="reference internal" href="../reference/response/index.html#litestar.response.Redirect" title="litestar.response.Redirect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Redirect</span></code></a></p></li>
<li><p>return an instance of the <a class="reference internal" href="../reference/response/index.html#litestar.response.Redirect" title="litestar.response.Redirect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Redirect</span></code></a> class with the desired redirect path</p></li>
</ul>
</section>
<section id="file-responses">
<h2>File Responses<a class="headerlink" href="#file-responses" title="Link to this heading">¶</a></h2>
<p>File responses send a file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">File</span>
</span><span data-line="4">
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/file-download&quot;</span><span class="p">)</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">handle_file_download</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">File</span><span class="p">:</span>
</span><span data-line="8">    <span class="k">return</span> <span class="n">File</span><span class="p">(</span>
</span><span data-line="9">        <span class="n">path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;report&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.pdf&quot;</span><span class="p">),</span>
</span><span data-line="10">        <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;report.pdf&quot;</span><span class="p">,</span>
</span><span data-line="11">    <span class="p">)</span>
</span></pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">path</span></code> is the path of the file to be sent and <code class="docutils literal notranslate"><span class="pre">filename</span></code> an optional filename to set
in the response <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition">Content-Disposition</a>
attachment.</p>
<section id="media-types">
<h3>Media types<a class="headerlink" href="#media-types" title="Link to this heading">¶</a></h3>
<p>If <code class="docutils literal notranslate"><span class="pre">filename</span></code> is provided, Litestar will try to guess the MIME type, otherwise fall
back to <code class="docutils literal notranslate"><span class="pre">application/octet-stream</span></code>. If the type cannot be inferred via the file name,
you can set it manually via <code class="docutils literal notranslate"><span class="pre">media_type</span></code></p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">get</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">File</span>
</span><span data-line="4">
</span><span data-line="5">
</span><span data-line="6"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/file-download&quot;</span><span class="p">,</span> <span class="n">media_type</span><span class="o">=</span><span class="s2">&quot;application/pdf&quot;</span><span class="p">)</span>
</span><span data-line="7"><span class="k">def</span><span class="w"> </span><span class="nf">handle_file_download</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">File</span><span class="p">:</span>
</span><span data-line="8">    <span class="k">return</span> <span class="n">File</span><span class="p">(</span>
</span><span data-line="9">        <span class="n">path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="s2">&quot;report&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s2">&quot;.pdf&quot;</span><span class="p">),</span>
</span><span data-line="10">        <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;report.pdf&quot;</span><span class="p">,</span>
</span><span data-line="11">    <span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="streaming">
<h3>Streaming<a class="headerlink" href="#streaming" title="Link to this heading">¶</a></h3>
<p>File responses are streamed or sent in one chunk. This depends on the file’s size and
the <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code> set, which defaults to 1 MB. If the file exceeds <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code>, it
will be streamed.</p>
</section>
<section id="file-systems">
<h3>File systems<a class="headerlink" href="#file-systems" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="../reference/response/index.html#litestar.response.File" title="litestar.response.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> supports Litestar’s <em>file system protocol and registry</em>.
If no file system is passed explicitly, files will be sent using the registry’s default
file system, which itself defaults to
<a class="reference internal" href="../reference/file_system.html#litestar.file_system.BaseLocalFileSystem" title="litestar.file_system.BaseLocalFileSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLocalFileSystem</span></code></a>, sending files from disk.
In addition to Litestar’s own file system protocol, all
<a class="reference external" href="https://filesystem-spec.readthedocs.io/en/latest/">fsspec</a> file systems are
supported.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Sending files from S3</span><a class="headerlink" href="#id7" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">File</span>
</span><span data-line="5">
</span><span data-line="6"><span class="n">s3_fs</span> <span class="o">=</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">filesystem</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="n">asynchronous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/{file_name:str}&quot;</span><span class="p">)</span>
</span><span data-line="10"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">file_handler</span><span class="p">(</span><span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">File</span><span class="p">:</span>
</span><span data-line="11">    <span class="k">return</span> <span class="n">File</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_system</span><span class="o">=</span><span class="n">s3_fs</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">([</span><span class="n">file_handler</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Sending files from S3 by using the registry</span><a class="headerlink" href="#id8" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">fsspec</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.file_system</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileSystemRegistry</span>
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">File</span>
</span><span data-line="6">
</span><span data-line="7">
</span><span data-line="8"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/{file_name:str}&quot;</span><span class="p">)</span>
</span><span data-line="9"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">file_handler</span><span class="p">(</span><span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">File</span><span class="p">:</span>
</span><span data-line="10">    <span class="k">return</span> <span class="n">File</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_system</span><span class="o">=</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
</span><span data-line="11">
</span><span data-line="12">
</span><span data-line="13"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span>
</span><span data-line="14">    <span class="p">[</span><span class="n">file_handler</span><span class="p">],</span>
</span><span data-line="15">    <span class="n">plugins</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="16">        <span class="n">FileSystemRegistry</span><span class="p">({</span><span class="s2">&quot;s3&quot;</span><span class="p">:</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">filesystem</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="n">asynchronous</span><span class="o">=</span><span class="kc">True</span><span class="p">)}),</span>
</span><span data-line="17">    <span class="p">],</span>
</span><span data-line="18"><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
</section>
<section id="streaming-responses">
<h2>Streaming Responses<a class="headerlink" href="#streaming-responses" title="Link to this heading">¶</a></h2>
<p>To return a streaming response use the <a class="reference internal" href="../reference/response/index.html#litestar.response.Stream" title="litestar.response.Stream"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></a> class. The class
receives a single positional arg, that must be an iterator delivering the stream:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">asyncio</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncGenerator</span>
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">Stream</span>
</span><span data-line="7"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.serialization</span><span class="w"> </span><span class="kn">import</span> <span class="n">encode_json</span>
</span><span data-line="8">
</span><span data-line="9">
</span><span data-line="10"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span data-line="11">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span data-line="12">        <span class="k">await</span> <span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</span><span data-line="13">        <span class="k">yield</span> <span class="n">encode_json</span><span class="p">({</span><span class="s2">&quot;current_time&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()})</span>
</span><span data-line="14">
</span><span data-line="15">
</span><span data-line="16"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/time&quot;</span><span class="p">)</span>
</span><span data-line="17"><span class="k">def</span><span class="w"> </span><span class="nf">stream_time</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Stream</span><span class="p">:</span>
</span><span data-line="18">    <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">my_generator</span><span class="p">())</span>
</span><span data-line="19">
</span><span data-line="20">
</span><span data-line="21"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">stream_time</span><span class="p">])</span>
</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use different kinds of values for the iterator. It can be a callable returning a sync or async generator,
a generator itself, a sync or async iterator class, or an instance of a sync or async iterator class.</p>
</div>
</section>
<section id="server-sent-event-responses">
<h2>Server Sent Event Responses<a class="headerlink" href="#server-sent-event-responses" title="Link to this heading">¶</a></h2>
<p>To send <cite>server-sent-events</cite> or SSEs to the frontend, use the <a class="reference internal" href="../reference/response/index.html#litestar.response.ServerSentEvent" title="litestar.response.ServerSentEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServerSentEvent</span></code></a>
class. The class receives a content arg. You can additionally specify <code class="docutils literal notranslate"><span class="pre">event_type</span></code>, which is the
name of the event as declared in the browser, the <code class="docutils literal notranslate"><span class="pre">event_id</span></code>, which sets the event source property, <code class="docutils literal notranslate"><span class="pre">comment_message</span></code>,
which is used in for sending pings, and <code class="docutils literal notranslate"><span class="pre">retry_duration</span></code>, which dictates the duration for retrying.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">asyncio</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncGenerator</span>
</span><span data-line="3">
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">ServerSentEvent</span><span class="p">,</span> <span class="n">ServerSentEventMessage</span>
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">SSEData</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">my_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="n">SSEData</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span data-line="10">    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span data-line="11">    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
</span><span data-line="12">        <span class="k">await</span> <span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</span><span data-line="13">        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span data-line="14">        <span class="c1"># In the generator you can yield integers, strings, bytes, dictionaries, or ServerSentEventMessage objects</span>
</span><span data-line="15">        <span class="c1"># dicts can have the following keys: data, event, id, retry, comment</span>
</span><span data-line="16">
</span><span data-line="17">        <span class="c1"># here we yield an integer</span>
</span><span data-line="18">        <span class="k">yield</span> <span class="n">count</span>
</span><span data-line="19">        <span class="c1"># here a string</span>
</span><span data-line="20">        <span class="k">yield</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span data-line="21">        <span class="c1"># here bytes</span>
</span><span data-line="22">        <span class="k">yield</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span data-line="23">        <span class="c1"># here a dictionary</span>
</span><span data-line="24">        <span class="k">yield</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">count</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;event2&quot;</span><span class="p">,</span> <span class="s2">&quot;retry&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
</span><span data-line="25">        <span class="c1"># here a ServerSentEventMessage object</span>
</span><span data-line="26">        <span class="k">yield</span> <span class="n">ServerSentEventMessage</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="s2">&quot;something-with-comment&quot;</span><span class="p">,</span> <span class="n">retry</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;some comment&quot;</span><span class="p">)</span>
</span><span data-line="27">
</span><span data-line="28">
</span><span data-line="29"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/count&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="30"><span class="k">def</span><span class="w"> </span><span class="nf">sse_handler</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ServerSentEvent</span><span class="p">:</span>
</span><span data-line="31">    <span class="k">return</span> <span class="n">ServerSentEvent</span><span class="p">(</span><span class="n">my_generator</span><span class="p">())</span>
</span><span data-line="32">
</span><span data-line="33">
</span><span data-line="34"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">sse_handler</span><span class="p">])</span>
</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use different kinds of values for the iterator. It can be a callable returning a sync or async generator,
a generator itself, a sync or async iterator class, or an instance of a sync or async iterator class.</p>
</div>
<p>In your iterator function you can yield integers, strings or bytes, the message sent in that case will have <code class="docutils literal notranslate"><span class="pre">message</span></code>
as the <code class="docutils literal notranslate"><span class="pre">event_type</span></code> if the ServerSentEvent has no <code class="docutils literal notranslate"><span class="pre">event_type</span></code> set, otherwise it will use the <code class="docutils literal notranslate"><span class="pre">event_type</span></code>
specified, and the data will be the yielded value.</p>
<p>If you want to send a different event type, you can use a dictionary with the keys <code class="docutils literal notranslate"><span class="pre">event_type</span></code> and <code class="docutils literal notranslate"><span class="pre">data</span></code> or the <a class="reference internal" href="../reference/response/index.html#litestar.response.ServerSentEventMessage" title="litestar.response.ServerSentEventMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServerSentEventMessage</span></code></a> class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can further customize all the sse parameters, add comments, and set the retry duration by using the <a class="reference internal" href="../reference/response/index.html#litestar.response.ServerSentEvent" title="litestar.response.ServerSentEvent"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServerSentEvent</span></code></a> class directly or by using the <a class="reference internal" href="../reference/response/index.html#litestar.response.ServerSentEventMessage" title="litestar.response.ServerSentEventMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">ServerSentEventMessage</span></code></a> or dictionaries with the appropriate keys.</p>
</div>
</section>
<section id="template-responses">
<h2>Template Responses<a class="headerlink" href="#template-responses" title="Link to this heading">¶</a></h2>
<p>Template responses are used to render templates into HTML. To use a template response you must first
<a class="reference internal" href="templating.html#registering-a-template-engine"><span class="std std-ref">register a template engine</span></a> on the application level. Once an
engine is in place, you can use a template response like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.response</span><span class="w"> </span><span class="kn">import</span> <span class="n">Template</span>
</span><span data-line="3">
</span><span data-line="4">
</span><span data-line="5"><span class="nd">@get</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;/info&quot;</span><span class="p">)</span>
</span><span data-line="6"><span class="k">def</span><span class="w"> </span><span class="nf">info</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Template</span><span class="p">:</span>
</span><span data-line="7">    <span class="k">return</span> <span class="n">Template</span><span class="p">(</span><span class="n">template_name</span><span class="o">=</span><span class="s2">&quot;info.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="p">})</span>
</span></pre></div>
</div>
<p>In the above example, <a class="reference internal" href="../reference/response/index.html#litestar.response.Template" title="litestar.response.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code></a> is passed the template name, which is a
path like value, and a context dictionary that maps string keys into values that will be rendered in the template.</p>
</section>
<section id="custom-responses">
<h2>Custom Responses<a class="headerlink" href="#custom-responses" title="Link to this heading">¶</a></h2>
<p>While Litestar supports the serialization of many types by default, sometimes you want to return something that’s not
supported. In those cases it’s convenient to make use of a custom response class.</p>
<p>The example below illustrates how to deal with <a class="reference internal" href="../reference/datastructures/index.html#litestar.datastructures.MultiDict" title="litestar.datastructures.MultiDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiDict</span></code></a>
instances.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.datastructures</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiDict</span>
</span><span data-line="3">
</span><span data-line="4">
</span><span data-line="5"><span class="k">class</span><span class="w"> </span><span class="nc">MultiDictResponse</span><span class="p">(</span><span class="n">Response</span><span class="p">):</span>
</span><span data-line="6">    <span class="n">type_encoders</span> <span class="o">=</span> <span class="p">{</span><span class="n">MultiDict</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">dict</span><span class="p">()}</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
</span><span data-line="10"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MultiDict</span><span class="p">:</span>
</span><span data-line="11">    <span class="k">return</span> <span class="n">MultiDict</span><span class="p">([(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">)])</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">([</span><span class="n">index</span><span class="p">],</span> <span class="n">response_class</span><span class="o">=</span><span class="n">MultiDictResponse</span><span class="p">)</span>
</span></pre></div>
</div>
<div class="admonition">
<p class="admonition-title">Run it</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span data-line="1">&gt;<span class="w"> </span>curl<span class="w"> </span>http://127.0.0.1:8000/
</span><span data-line="2"><span class="o">{</span><span class="s2">&quot;foo&quot;</span>:<span class="o">[</span><span class="s2">&quot;bar&quot;</span>,<span class="s2">&quot;baz&quot;</span><span class="o">]}</span>
</span></pre></div>
</div>
</div>
<div class="seealso admonition">
<p class="admonition-title">Layered architecture</p>
<p>Response classes are part of Litestar’s layered architecture, which means you can
set a response class on every layer of the application. If you have set a response
class on multiple layers, the layer closest to the route handler will take precedence.</p>
<p>You can read more about this here: <a class="reference internal" href="applications.html#layered-architecture"><span class="std std-ref">Layered architecture</span></a></p>
</div>
</section>
<section id="background-tasks">
<h2>Background Tasks<a class="headerlink" href="#background-tasks" title="Link to this heading">¶</a></h2>
<p>All Litestar responses allow passing in a <code class="docutils literal notranslate"><span class="pre">background</span></code> kwarg. This kwarg accepts either an instance of
<a class="reference internal" href="../reference/background_tasks.html#litestar.background_tasks.BackgroundTask" title="litestar.background_tasks.BackgroundTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundTask</span></code></a> or an instance of
<a class="reference internal" href="../reference/background_tasks.html#litestar.background_tasks.BackgroundTasks" title="litestar.background_tasks.BackgroundTasks"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundTasks</span></code></a>, which wraps an iterable of
<a class="reference internal" href="../reference/background_tasks.html#litestar.background_tasks.BackgroundTask" title="litestar.background_tasks.BackgroundTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundTask</span></code></a> instances.</p>
<p>A background task is a sync or async callable (function, method, or class that implements the <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#object.__call__" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">object.__call__()</span></code></a>
dunder method) that will be called after the response finishes sending the data.</p>
<p>Thus, in the following example the passed in background task will be executed after the response sends:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Background Task Passed into Response</span><a class="headerlink" href="#id9" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.background_tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">BackgroundTask</span>
</span><span data-line="5">
</span><span data-line="6"><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">logging_task</span><span class="p">(</span><span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="10">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span data-line="11">
</span><span data-line="12">
</span><span data-line="13"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="14"><span class="k">def</span><span class="w"> </span><span class="nf">greeter</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
</span><span data-line="15">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="16">        <span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">},</span>
</span><span data-line="17">        <span class="n">background</span><span class="o">=</span><span class="n">BackgroundTask</span><span class="p">(</span><span class="n">logging_task</span><span class="p">,</span> <span class="s2">&quot;greeter&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;was called with name </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
</span><span data-line="18">    <span class="p">)</span>
</span><span data-line="19">
</span><span data-line="20">
</span><span data-line="21"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">greeter</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">greeter</span></code> handler is called, the logging task will be called with any <code class="docutils literal notranslate"><span class="pre">*args</span></code> and <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> passed into
the <a class="reference internal" href="../reference/background_tasks.html#litestar.background_tasks.BackgroundTask" title="litestar.background_tasks.BackgroundTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundTask</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the above example <code class="docutils literal notranslate"><span class="pre">&quot;greeter&quot;</span></code> is an arg and <code class="docutils literal notranslate"><span class="pre">message=f&quot;was</span> <span class="pre">called</span> <span class="pre">with</span> <span class="pre">name</span> <span class="pre">{name}&quot;</span></code> is a kwarg.
The function signature of <code class="docutils literal notranslate"><span class="pre">logging_task</span></code> allows for this, so this should pose no problem.
<a class="reference internal" href="../reference/background_tasks.html#litestar.background_tasks.BackgroundTask" title="litestar.background_tasks.BackgroundTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundTask</span></code></a> is typed with <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.ParamSpec" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParamSpec</span></code></a>,
enabling correct type checking for arguments and keyword arguments passed to it.</p>
</div>
<p>Route decorators (e.g. <code class="docutils literal notranslate"><span class="pre">&#64;get</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;post</span></code>, etc.) also allow passing in a background task with the <code class="docutils literal notranslate"><span class="pre">background</span></code> kwarg:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Background Task Passed into Decorator</span><a class="headerlink" href="#id10" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.background_tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">BackgroundTask</span>
</span><span data-line="5">
</span><span data-line="6"><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span data-line="7">
</span><span data-line="8">
</span><span data-line="9"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">logging_task</span><span class="p">(</span><span class="n">identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="10">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</span><span data-line="11">
</span><span data-line="12">
</span><span data-line="13"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">BackgroundTask</span><span class="p">(</span><span class="n">logging_task</span><span class="p">,</span> <span class="s2">&quot;greeter&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;was called&quot;</span><span class="p">),</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="14"><span class="k">def</span><span class="w"> </span><span class="nf">greeter</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span data-line="15">    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span>
</span><span data-line="16">
</span><span data-line="17">
</span><span data-line="18"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">greeter</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Route handler arguments cannot be passed into background tasks when they are passed into decorators.</p>
</div>
<section id="executing-multiple-background-tasks">
<h3>Executing Multiple Background Tasks<a class="headerlink" href="#executing-multiple-background-tasks" title="Link to this heading">¶</a></h3>
<p>You can also use the <a class="reference internal" href="../reference/background_tasks.html#litestar.background_tasks.BackgroundTasks" title="litestar.background_tasks.BackgroundTasks"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundTasks</span></code></a> class and pass to it an iterable
(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>, etc.) of <a class="reference internal" href="../reference/background_tasks.html#litestar.background_tasks.BackgroundTask" title="litestar.background_tasks.BackgroundTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundTask</span></code></a> instances:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Multiple Background Tasks</span><a class="headerlink" href="#id11" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.background_tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">BackgroundTask</span><span class="p">,</span> <span class="n">BackgroundTasks</span>
</span><span data-line="5">
</span><span data-line="6"><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span data-line="7"><span class="n">greeted</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span data-line="8">
</span><span data-line="9">
</span><span data-line="10"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">logging_task</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="11">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> was greeted&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">saving_task</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="15">    <span class="n">greeted</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span data-line="16">
</span><span data-line="17">
</span><span data-line="18"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="19"><span class="k">def</span><span class="w"> </span><span class="nf">greeter</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
</span><span data-line="20">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span>
</span><span data-line="21">        <span class="p">{</span><span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">},</span>
</span><span data-line="22">        <span class="n">background</span><span class="o">=</span><span class="n">BackgroundTasks</span><span class="p">(</span>
</span><span data-line="23">            <span class="p">[</span>
</span><span data-line="24">                <span class="n">BackgroundTask</span><span class="p">(</span><span class="n">logging_task</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
</span><span data-line="25">                <span class="n">BackgroundTask</span><span class="p">(</span><span class="n">saving_task</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
</span><span data-line="26">            <span class="p">]</span>
</span><span data-line="27">        <span class="p">),</span>
</span><span data-line="28">    <span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30">
</span><span data-line="31"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">greeter</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
<p><a class="reference internal" href="../reference/background_tasks.html#litestar.background_tasks.BackgroundTasks" title="litestar.background_tasks.BackgroundTasks"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackgroundTasks</span></code></a> class
accepts an optional keyword argument <code class="docutils literal notranslate"><span class="pre">run_in_task_group</span></code> with a default value of <code class="docutils literal notranslate"><span class="pre">False</span></code>. Setting this to <code class="docutils literal notranslate"><span class="pre">True</span></code>
allows background tasks to run concurrently, using an <a class="reference external" href="https://anyio.readthedocs.io/en/stable/tasks.html">anyio.task_group</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">run_in_task_group</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> will not preserve execution order.</p>
</div>
</section>
</section>
<section id="pagination">
<h2>Pagination<a class="headerlink" href="#pagination" title="Link to this heading">¶</a></h2>
<p>When you need to return a large number of items from an endpoint it is common practice to use pagination to ensure
clients can request a specific subset or “page” from the total dataset. Litestar supports three types of pagination out
of the box:</p>
<ul class="simple">
<li><p>classic pagination</p></li>
<li><p>limit / offset pagination</p></li>
<li><p>cursor pagination</p></li>
</ul>
<section id="classic-pagination">
<h3>Classic Pagination<a class="headerlink" href="#classic-pagination" title="Link to this heading">¶</a></h3>
<p>In classic pagination the dataset is divided into pages of a specific size and the consumer then requests a specific page.</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">Classic Pagination</span><a class="headerlink" href="#id12" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">polyfactory.factories.pydantic_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelFactory</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="3">
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.pagination</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractSyncClassicPaginator</span><span class="p">,</span> <span class="n">ClassicPagination</span>
</span><span data-line="6">
</span><span data-line="7">
</span><span data-line="8"><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="9">    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="10">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="11">
</span><span data-line="12">
</span><span data-line="13"><span class="k">class</span><span class="w"> </span><span class="nc">PersonFactory</span><span class="p">(</span><span class="n">ModelFactory</span><span class="p">[</span><span class="n">Person</span><span class="p">]):</span>
</span><span data-line="14">    <span class="n">__model__</span> <span class="o">=</span> <span class="n">Person</span>
</span><span data-line="15">
</span><span data-line="16">
</span><span data-line="17"><span class="c1"># we will implement a paginator - the paginator must implement two methods &#39;get_total&#39; and &#39;get_items&#39;</span>
</span><span data-line="18"><span class="c1"># we would usually use a database for this, but for our case we will &quot;fake&quot; the dataset using a factory.</span>
</span><span data-line="19">
</span><span data-line="20">
</span><span data-line="21"><span class="k">class</span><span class="w"> </span><span class="nc">PersonClassicPaginator</span><span class="p">(</span><span class="n">AbstractSyncClassicPaginator</span><span class="p">[</span><span class="n">Person</span><span class="p">]):</span>
</span><span data-line="22">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="23">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">PersonFactory</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25">    <span class="k">def</span><span class="w"> </span><span class="nf">get_total</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="26">        <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="n">page_size</span><span class="p">)</span>
</span><span data-line="27">
</span><span data-line="28">    <span class="k">def</span><span class="w"> </span><span class="nf">get_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_page</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Person</span><span class="p">]:</span>
</span><span data-line="29">        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">page_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="n">page_size</span><span class="p">)][</span><span class="n">current_page</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span data-line="30">
</span><span data-line="31">
</span><span data-line="32"><span class="n">paginator</span> <span class="o">=</span> <span class="n">PersonClassicPaginator</span><span class="p">()</span>
</span><span data-line="33">
</span><span data-line="34">
</span><span data-line="35"><span class="c1"># we now create a regular handler. The handler will receive two query parameters - &#39;page_size&#39; and &#39;current_page&#39;, which</span>
</span><span data-line="36"><span class="c1"># we will pass to the paginator.</span>
</span><span data-line="37"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/people&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="38"><span class="k">def</span><span class="w"> </span><span class="nf">people_handler</span><span class="p">(</span><span class="n">page_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">current_page</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ClassicPagination</span><span class="p">[</span><span class="n">Person</span><span class="p">]:</span>
</span><span data-line="39">    <span class="k">return</span> <span class="n">paginator</span><span class="p">(</span><span class="n">page_size</span><span class="o">=</span><span class="n">page_size</span><span class="p">,</span> <span class="n">current_page</span><span class="o">=</span><span class="n">current_page</span><span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41">
</span><span data-line="42"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">people_handler</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
<p>The data container for this pagination is called <a class="reference internal" href="../reference/pagination.html#litestar.pagination.ClassicPagination" title="litestar.pagination.ClassicPagination"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassicPagination</span></code></a>, which is
what will be returned by the paginator in the above example This will also generate the corresponding OpenAPI
documentation.</p>
<p>If you require async logic, you can implement
the <a class="reference internal" href="../reference/pagination.html#litestar.pagination.AbstractAsyncClassicPaginator" title="litestar.pagination.AbstractAsyncClassicPaginator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractAsyncClassicPaginator</span></code></a> instead of the
<a class="reference internal" href="../reference/pagination.html#litestar.pagination.AbstractSyncClassicPaginator" title="litestar.pagination.AbstractSyncClassicPaginator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractSyncClassicPaginator</span></code></a>.</p>
</section>
<section id="offset-pagination">
<h3>Offset Pagination<a class="headerlink" href="#offset-pagination" title="Link to this heading">¶</a></h3>
<p>In offset pagination the consumer requests a number of items specified by <code class="docutils literal notranslate"><span class="pre">limit</span></code> and the <code class="docutils literal notranslate"><span class="pre">offset</span></code> from the beginning of the dataset.
For example, given a list of 50 items, you could request <code class="docutils literal notranslate"><span class="pre">limit=10</span></code>, <code class="docutils literal notranslate"><span class="pre">offset=39</span></code> to request items 40-50.</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">Offset Pagination</span><a class="headerlink" href="#id13" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">islice</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">polyfactory.factories.pydantic_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelFactory</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="7"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.pagination</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractSyncOffsetPaginator</span><span class="p">,</span> <span class="n">OffsetPagination</span>
</span><span data-line="8">
</span><span data-line="9">
</span><span data-line="10"><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="11">    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="12">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="13">
</span><span data-line="14">
</span><span data-line="15"><span class="k">class</span><span class="w"> </span><span class="nc">PersonFactory</span><span class="p">(</span><span class="n">ModelFactory</span><span class="p">[</span><span class="n">Person</span><span class="p">]):</span>
</span><span data-line="16">    <span class="n">__model__</span> <span class="o">=</span> <span class="n">Person</span>
</span><span data-line="17">
</span><span data-line="18">
</span><span data-line="19"><span class="c1"># we will implement a paginator - the paginator must implement two methods &#39;get_total&#39; and &#39;get_items&#39;</span>
</span><span data-line="20"><span class="c1"># we would usually use a database for this, but for our case we will &quot;fake&quot; the dataset using a factory.</span>
</span><span data-line="21">
</span><span data-line="22">
</span><span data-line="23"><span class="k">class</span><span class="w"> </span><span class="nc">PersonOffsetPaginator</span><span class="p">(</span><span class="n">AbstractSyncOffsetPaginator</span><span class="p">[</span><span class="n">Person</span><span class="p">]):</span>
</span><span data-line="24">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="25">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">PersonFactory</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span><span data-line="26">
</span><span data-line="27">    <span class="k">def</span><span class="w"> </span><span class="nf">get_total</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="28">        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30">    <span class="k">def</span><span class="w"> </span><span class="nf">get_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Person</span><span class="p">]:</span>
</span><span data-line="31">        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">limit</span><span class="p">))</span>
</span><span data-line="32">
</span><span data-line="33">
</span><span data-line="34"><span class="n">paginator</span> <span class="o">=</span> <span class="n">PersonOffsetPaginator</span><span class="p">()</span>
</span><span data-line="35">
</span><span data-line="36">
</span><span data-line="37"><span class="c1"># we now create a regular handler. The handler will receive two query parameters - &#39;limit&#39; and &#39;offset&#39;, which</span>
</span><span data-line="38"><span class="c1"># we will pass to the paginator.</span>
</span><span data-line="39"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/people&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="40"><span class="k">def</span><span class="w"> </span><span class="nf">people_handler</span><span class="p">(</span><span class="n">limit</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OffsetPagination</span><span class="p">[</span><span class="n">Person</span><span class="p">]:</span>
</span><span data-line="41">    <span class="k">return</span> <span class="n">paginator</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
</span><span data-line="42">
</span><span data-line="43">
</span><span data-line="44"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">people_handler</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
<p>The data container for this pagination is
called <a class="reference internal" href="../reference/pagination.html#litestar.pagination.OffsetPagination" title="litestar.pagination.OffsetPagination"><code class="xref py py-class docutils literal notranslate"><span class="pre">OffsetPagination</span></code></a>, which is what will be returned by the paginator in the
above example This will also generate the corresponding OpenAPI documentation.</p>
<p>If you require async logic, you can implement
the <a class="reference internal" href="../reference/pagination.html#litestar.pagination.AbstractAsyncOffsetPaginator" title="litestar.pagination.AbstractAsyncOffsetPaginator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractAsyncOffsetPaginator</span></code></a> instead of the
<a class="reference internal" href="../reference/pagination.html#litestar.pagination.AbstractSyncOffsetPaginator" title="litestar.pagination.AbstractSyncOffsetPaginator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractSyncOffsetPaginator</span></code></a>.</p>
<section id="offset-pagination-with-sqlalchemy">
<h4>Offset Pagination With SQLAlchemy<a class="headerlink" href="#offset-pagination-with-sqlalchemy" title="Link to this heading">¶</a></h4>
<p>When retrieving paginated data from the database using SQLAlchemy, the Paginator instance requires an SQLAlchemy session
instance to make queries. This can be achieved with <a class="reference internal" href="dependency-injection.html"><span class="doc">Dependency Injection</span></a></p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">Offset Pagination With SQLAlchemy</span><a class="headerlink" href="#id14" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">cast</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">func</span><span class="p">,</span> <span class="n">select</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.orm</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mapped</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="7"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.di</span><span class="w"> </span><span class="kn">import</span> <span class="n">Provide</span>
</span><span data-line="8"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.pagination</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractAsyncOffsetPaginator</span><span class="p">,</span> <span class="n">OffsetPagination</span>
</span><span data-line="9"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.plugins.sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">SQLAlchemyAsyncConfig</span><span class="p">,</span> <span class="n">SQLAlchemyInitPlugin</span><span class="p">,</span> <span class="n">base</span>
</span><span data-line="10">
</span><span data-line="11"><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
</span><span data-line="12">    <span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.engine.result</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScalarResult</span>
</span><span data-line="13">    <span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.ext.asyncio</span><span class="w"> </span><span class="kn">import</span> <span class="n">AsyncSession</span>
</span><span data-line="14">
</span><span data-line="15">
</span><span data-line="16"><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">UUIDBase</span><span class="p">):</span>
</span><span data-line="17">    <span class="n">name</span><span class="p">:</span> <span class="n">Mapped</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span data-line="18">
</span><span data-line="19">
</span><span data-line="20"><span class="k">class</span><span class="w"> </span><span class="nc">PersonOffsetPaginator</span><span class="p">(</span><span class="n">AbstractAsyncOffsetPaginator</span><span class="p">[</span><span class="n">Person</span><span class="p">]):</span>
</span><span data-line="21">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">async_session</span><span class="p">:</span> <span class="n">AsyncSession</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># &#39;async_session&#39; dependency will be injected here.</span>
</span><span data-line="22">        <span class="bp">self</span><span class="o">.</span><span class="n">async_session</span> <span class="o">=</span> <span class="n">async_session</span>
</span><span data-line="23">
</span><span data-line="24">    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_total</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span data-line="25">        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_session</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">Person</span><span class="o">.</span><span class="n">id</span><span class="p">))))</span>
</span><span data-line="26">
</span><span data-line="27">    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Person</span><span class="p">]:</span>
</span><span data-line="28">        <span class="n">people</span><span class="p">:</span> <span class="n">ScalarResult</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">async_session</span><span class="o">.</span><span class="n">scalars</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="n">Person</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>
</span><span data-line="29">        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</span><span data-line="30">
</span><span data-line="31">
</span><span data-line="32"><span class="c1"># Create a route handler. The handler will receive two query parameters - &#39;limit&#39; and &#39;offset&#39;, which is passed</span>
</span><span data-line="33"><span class="c1"># to the paginator instance. Also create a dependency &#39;paginator&#39; which will be injected into the handler.</span>
</span><span data-line="34"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/people&quot;</span><span class="p">,</span> <span class="n">dependencies</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;paginator&quot;</span><span class="p">:</span> <span class="n">Provide</span><span class="p">(</span><span class="n">PersonOffsetPaginator</span><span class="p">)})</span>
</span><span data-line="35"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">people_handler</span><span class="p">(</span><span class="n">paginator</span><span class="p">:</span> <span class="n">PersonOffsetPaginator</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OffsetPagination</span><span class="p">[</span><span class="n">Person</span><span class="p">]:</span>
</span><span data-line="36">    <span class="k">return</span> <span class="k">await</span> <span class="n">paginator</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
</span><span data-line="37">
</span><span data-line="38">
</span><span data-line="39"><span class="n">sqlalchemy_config</span> <span class="o">=</span> <span class="n">SQLAlchemyAsyncConfig</span><span class="p">(</span>
</span><span data-line="40">    <span class="n">connection_string</span><span class="o">=</span><span class="s2">&quot;sqlite+aiosqlite:///test.sqlite&quot;</span><span class="p">,</span> <span class="n">session_dependency_key</span><span class="o">=</span><span class="s2">&quot;async_session&quot;</span>
</span><span data-line="41"><span class="p">)</span>  <span class="c1"># Create &#39;async_session&#39; dependency.</span>
</span><span data-line="42"><span class="n">sqlalchemy_plugin</span> <span class="o">=</span> <span class="n">SQLAlchemyInitPlugin</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">sqlalchemy_config</span><span class="p">)</span>
</span><span data-line="43">
</span><span data-line="44">
</span><span data-line="45"><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">on_startup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="46"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the database.&quot;&quot;&quot;</span>
</span><span data-line="47">    <span class="k">async</span> <span class="k">with</span> <span class="n">sqlalchemy_config</span><span class="o">.</span><span class="n">get_engine</span><span class="p">()</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
</span><span data-line="48">        <span class="k">await</span> <span class="n">conn</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">UUIDBase</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">create_all</span><span class="p">)</span>
</span><span data-line="49">
</span><span data-line="50">
</span><span data-line="51"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">people_handler</span><span class="p">],</span> <span class="n">on_startup</span><span class="o">=</span><span class="p">[</span><span class="n">on_startup</span><span class="p">],</span> <span class="n">plugins</span><span class="o">=</span><span class="p">[</span><span class="n">sqlalchemy_plugin</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
<p>See <a class="reference internal" href="databases/sqlalchemy/plugins/index.html#plugins"><span class="std std-ref">SQLAlchemy plugin</span></a> for sqlalchemy integration.</p>
</section>
</section>
<section id="cursor-pagination">
<h3>Cursor Pagination<a class="headerlink" href="#cursor-pagination" title="Link to this heading">¶</a></h3>
<p>In cursor pagination the consumer requests a number of items specified by <code class="docutils literal notranslate"><span class="pre">results_per_page</span></code> and a <code class="docutils literal notranslate"><span class="pre">cursor</span></code> after which results are given.
Cursor is unique identifier within the dataset that serves as a way to point the starting position.</p>
<div class="sd-tab-set docutils">
<input id="sd-tab-item-2" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="3.8" for="sd-tab-item-2">
Python 3.8+</label><div class="sd-tab-content docutils">
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">Cursor Pagination</span><a class="headerlink" href="#id15" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
</span><span data-line="2">
</span><span data-line="3"><span class="kn">from</span><span class="w"> </span><span class="nn">polyfactory.factories.pydantic_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelFactory</span>
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="7"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.pagination</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractSyncCursorPaginator</span><span class="p">,</span> <span class="n">CursorPagination</span>
</span><span data-line="8">
</span><span data-line="9">
</span><span data-line="10"><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="11">    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="12">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="13">
</span><span data-line="14">
</span><span data-line="15"><span class="k">class</span><span class="w"> </span><span class="nc">PersonFactory</span><span class="p">(</span><span class="n">ModelFactory</span><span class="p">[</span><span class="n">Person</span><span class="p">]):</span>
</span><span data-line="16">    <span class="n">__model__</span> <span class="o">=</span> <span class="n">Person</span>
</span><span data-line="17">
</span><span data-line="18">
</span><span data-line="19"><span class="c1"># we will implement a paginator - the paginator must implement the method &#39;get_items&#39;.</span>
</span><span data-line="20">
</span><span data-line="21">
</span><span data-line="22"><span class="k">class</span><span class="w"> </span><span class="nc">PersonCursorPaginator</span><span class="p">(</span><span class="n">AbstractSyncCursorPaginator</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Person</span><span class="p">]):</span>
</span><span data-line="23">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="24">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">PersonFactory</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span><span data-line="25">
</span><span data-line="26">    <span class="k">def</span><span class="w"> </span><span class="nf">get_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">results_per_page</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Person</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span data-line="27">        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="n">results_per_page</span><span class="p">]</span>
</span><span data-line="28">        <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span>
</span><span data-line="29">
</span><span data-line="30">
</span><span data-line="31"><span class="n">paginator</span> <span class="o">=</span> <span class="n">PersonCursorPaginator</span><span class="p">()</span>
</span><span data-line="32">
</span><span data-line="33">
</span><span data-line="34"><span class="c1"># we now create a regular handler. The handler will receive a single query parameter - &#39;cursor&#39;, which</span>
</span><span data-line="35"><span class="c1"># we will pass to the paginator.</span>
</span><span data-line="36"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/people&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="37"><span class="k">def</span><span class="w"> </span><span class="nf">people_handler</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">cursor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">results_per_page</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CursorPagination</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Person</span><span class="p">]:</span>
</span><span data-line="38">    <span class="k">return</span> <span class="n">paginator</span><span class="p">(</span><span class="n">cursor</span><span class="o">=</span><span class="n">cursor</span><span class="p">,</span> <span class="n">results_per_page</span><span class="o">=</span><span class="n">results_per_page</span><span class="p">)</span>
</span><span data-line="39">
</span><span data-line="40">
</span><span data-line="41"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">people_handler</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
</div>
<input checked="checked" id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="3.10" for="sd-tab-item-3">
Python 3.10+</label><div class="sd-tab-content docutils">
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">Cursor Pagination</span><a class="headerlink" href="#id16" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="kn">from</span><span class="w"> </span><span class="nn">polyfactory.factories.pydantic_factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelFactory</span>
</span><span data-line="2"><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>
</span><span data-line="3">
</span><span data-line="4"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar</span><span class="w"> </span><span class="kn">import</span> <span class="n">Litestar</span><span class="p">,</span> <span class="n">get</span>
</span><span data-line="5"><span class="kn">from</span><span class="w"> </span><span class="nn">litestar.pagination</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractSyncCursorPaginator</span><span class="p">,</span> <span class="n">CursorPagination</span>
</span><span data-line="6">
</span><span data-line="7">
</span><span data-line="8"><span class="k">class</span><span class="w"> </span><span class="nc">Person</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span><span data-line="9">    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="10">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="11">
</span><span data-line="12">
</span><span data-line="13"><span class="k">class</span><span class="w"> </span><span class="nc">PersonFactory</span><span class="p">(</span><span class="n">ModelFactory</span><span class="p">[</span><span class="n">Person</span><span class="p">]):</span>
</span><span data-line="14">    <span class="n">__model__</span> <span class="o">=</span> <span class="n">Person</span>
</span><span data-line="15">
</span><span data-line="16">
</span><span data-line="17"><span class="c1"># we will implement a paginator - the paginator must implement the method &#39;get_items&#39;.</span>
</span><span data-line="18">
</span><span data-line="19">
</span><span data-line="20"><span class="k">class</span><span class="w"> </span><span class="nc">PersonCursorPaginator</span><span class="p">(</span><span class="n">AbstractSyncCursorPaginator</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Person</span><span class="p">]):</span>
</span><span data-line="21">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="22">        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">PersonFactory</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24">    <span class="k">def</span><span class="w"> </span><span class="nf">get_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cursor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">results_per_page</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Person</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
</span><span data-line="25">        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="n">results_per_page</span><span class="p">]</span>
</span><span data-line="26">        <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span>
</span><span data-line="27">
</span><span data-line="28">
</span><span data-line="29"><span class="n">paginator</span> <span class="o">=</span> <span class="n">PersonCursorPaginator</span><span class="p">()</span>
</span><span data-line="30">
</span><span data-line="31">
</span><span data-line="32"><span class="c1"># we now create a regular handler. The handler will receive a single query parameter - &#39;cursor&#39;, which</span>
</span><span data-line="33"><span class="c1"># we will pass to the paginator.</span>
</span><span data-line="34"><span class="nd">@get</span><span class="p">(</span><span class="s2">&quot;/people&quot;</span><span class="p">,</span> <span class="n">sync_to_thread</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="35"><span class="k">def</span><span class="w"> </span><span class="nf">people_handler</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">cursor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">results_per_page</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CursorPagination</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Person</span><span class="p">]:</span>
</span><span data-line="36">    <span class="k">return</span> <span class="n">paginator</span><span class="p">(</span><span class="n">cursor</span><span class="o">=</span><span class="n">cursor</span><span class="p">,</span> <span class="n">results_per_page</span><span class="o">=</span><span class="n">results_per_page</span><span class="p">)</span>
</span><span data-line="37">
</span><span data-line="38">
</span><span data-line="39"><span class="n">app</span> <span class="o">=</span> <span class="n">Litestar</span><span class="p">(</span><span class="n">route_handlers</span><span class="o">=</span><span class="p">[</span><span class="n">people_handler</span><span class="p">])</span>
</span></pre></div>
</div>
</div>
</div>
</div>
<p>The data container for this pagination is called <a class="reference internal" href="../reference/pagination.html#litestar.pagination.CursorPagination" title="litestar.pagination.CursorPagination"><code class="xref py py-class docutils literal notranslate"><span class="pre">CursorPagination</span></code></a>, which is what
will be returned by the paginator in the above example This will also generate the corresponding OpenAPI documentation.</p>
<p>If you require async logic, you can implement
the <a class="reference internal" href="../reference/pagination.html#litestar.pagination.AbstractAsyncCursorPaginator" title="litestar.pagination.AbstractAsyncCursorPaginator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractAsyncCursorPaginator</span></code></a> instead of the
<a class="reference internal" href="../reference/pagination.html#litestar.pagination.AbstractSyncCursorPaginator" title="litestar.pagination.AbstractSyncCursorPaginator"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractSyncCursorPaginator</span></code></a>.</p>
</section>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="plugins/problem_details.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">Problem Details</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="security/index.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">Security</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2025, Litestar Organization</p>
  
  <p>
    Made with
    
    <a href="https://www.sphinx-doc.org/">Sphinx</a> and
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials">
<a href="https://twitter.com/LitestarAPI" aria-label="X (Twitter)">
  <iconify-icon icon="prime:twitter"></iconify-icon>
</a>
<a href="https://discord.gg/litestar" aria-label="Discord">
  <iconify-icon icon="simple-icons:discord"></iconify-icon>
</a>
<a href="https://www.reddit.com/r/LitestarAPI" aria-label="Reddit">
  <iconify-icon icon="simple-icons:reddit"></iconify-icon>
</a></div>
    </div>
  </div>
</footer>
      <script src="../_static/documentation_options.js?v=ad404a94"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/litestar-theme.js?v=ab2dcc9e"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/shibuya.js?v=c477d091"></script>
      <script src="../_static/versioning.js?v=9ab184b9"></script></body>
</html>